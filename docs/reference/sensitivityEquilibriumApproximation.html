<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In this context, the sensitivity S(t;x,p) is dx(t;p)/dp, where
x(t;p) is the parameterized solution to an initial value problem
for ordinary differential equations and t is the independent
varibale: x'=f(t,x;p), where «'» indicates the derivative with
respect to t. In cases where you have a proxy variable for p,
e.g. r=log(p), the chain rule applies. Similarly, we also have an
output sensitivity for the function g(x(t;p)).  The equilibrium
approximation is exact for state-variable values close to an
equilibrium point q(p) (fixed-point): f(t,q(p);p)=0."><title>Equilibrium state approximation of the solution sensitivity for ODE systems — sensitivityEquilibriumApproximation • uqsa</title><script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Equilibrium state approximation of the solution sensitivity for ODE systems — sensitivityEquilibriumApproximation"><meta property="og:description" content="In this context, the sensitivity S(t;x,p) is dx(t;p)/dp, where
x(t;p) is the parameterized solution to an initial value problem
for ordinary differential equations and t is the independent
varibale: x'=f(t,x;p), where «'» indicates the derivative with
respect to t. In cases where you have a proxy variable for p,
e.g. r=log(p), the chain rule applies. Similarly, we also have an
output sensitivity for the function g(x(t;p)).  The equilibrium
approximation is exact for state-variable values close to an
equilibrium point q(p) (fixed-point): f(t,q(p);p)=0."><!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/install.html">Full Installation Instructions</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
    <h6 class="dropdown-header" data-toc-skip>Model and data management</h6>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing a model</a>
    <a class="dropdown-item" href="../articles/data.html">Importing data</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Paremeter estimation and uncertainty quantification</h6>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a model</a>
    <a class="dropdown-item" href="../articles/ABC_sampling.html">ABC sampling</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Sensitivity analysis</h6>
    <a class="dropdown-item" href="../articles/GSA.html">GSA following UQ</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/simAKAP79.html">Simulate AKAP79</a>
    <a class="dropdown-item" href="../articles/AKAP79.html">sample AKAP79</a>
    <a class="dropdown-item" href="../articles/AKAR4.html">sample AKAR4 with ABC</a>
    <a class="dropdown-item" href="../articles/AKAR4cl.html">sample AKAR4 with MCMC</a>
    <a class="dropdown-item" href="../articles/shortMakeSharedLibrary.html">Build a Model</a>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Equilibrium state approximation of the solution sensitivity for ODE systems</h1>
      
      <div class="d-none name"><code>sensitivityEquilibriumApproximation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In this context, the sensitivity S(t;x,p) is dx(t;p)/dp, where
x(t;p) is the parameterized solution to an initial value problem
for ordinary differential equations and t is the independent
varibale: x'=f(t,x;p), where «'» indicates the derivative with
respect to t. In cases where you have a proxy variable for p,
e.g. r=log(p), the chain rule applies. Similarly, we also have an
output sensitivity for the function g(x(t;p)).  The equilibrium
approximation is exact for state-variable values close to an
equilibrium point q(p) (fixed-point): f(t,q(p);p)=0.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sensitivityEquilibriumApproximation</span><span class="op">(</span></span>
<span>  <span class="va">experiments</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  parMap <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  parMapJac <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>experiments</dt>
<dd><p>a list of simulation experiments</p></dd>


<dt>model</dt>
<dd><p>a list of functions for the model the experiments are
applicable to</p></dd>


<dt>parMap</dt>
<dd><p>a map to transform parMCMC into p, parameters the
model accepts</p></dd>


<dt>simulations</dt>
<dd><p>an equivalent list of simulation results, for
one parameter vector</p></dd>


<dt>parMCMC</dt>
<dd><p>the parameters that are used in Markov chain Monte
Carlo as the MC variable</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a function S(parMCMC) -&gt;
simulations_with_sensitivity, which attaches the state
sensitivity matrix array length(x) × length(p) × length(t) to
the simulations (solutions to the ODE).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The state sensitivity matrix:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>           d <span class="fu">state</span>(time[k],state, param)[i]</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>S[i,j,k] <span class="ot">=</span> <span class="sc">--------------------------------</span>  ,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>           d param[j]</span></code></pre><p></p></div>
<p>where param are the raw model parameters.
This matrix is calculated as an intermediate and then transformed into:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>            d <span class="fu">func</span>(time[k], state, <span class="fu">c</span>(<span class="fu">parMap</span>(parMCMC),input))[i]</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>Sh[i,j,k] <span class="ot">=</span> <span class="sc">--------------------------------------------------</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>            d parMCMC[j]</span></code></pre><p></p></div>
<p>where parMCMC is the Markov chain variable and usually shorter than
param as we typically don't sample all of the model's
parameters. Some model parameters may be known, some may be input
parameters not intrinsic to the model but related to the
experimental setup (that is why parMCMC and param are different).</p>
<p>This transformation requires the output function jacobian (funcJac)
and the parameter jacobian (funcJacp) in the model variable.</p>
<p>As we transform the parameters themselves, the chain rule requests
parMapJacl,k = d paraml / d parMCMCk</p>
<p>Typically, the sensitivity needs to be known at different
time-points t_k. The 3-dimensional array Si,j,k, where the index k corrsponds to time
t_k; the closer x(t_k) is to equilibrium, the better the
approximation; near the initial state, the sensitivity is also
correct (only the intermediate time-span is approximate).</p>
<p>This function requires pracma::expm to work.</p>
<p>The f</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">parMCMC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu">sensitivityEquilibriumApproximation</span><span class="op">(</span><span class="va">experiments</span>, <span class="va">model</span>, <span class="va">parMap</span>, <span class="va">parMapJac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">S</span><span class="op">(</span><span class="va">parMap</span>,<span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

