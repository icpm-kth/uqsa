<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>Build your own Model • uqsa</title>
<script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build your own Model">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/installExplanations.html">Explanation for System Prerequisites</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Model and data management</h6>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing Models</a>
    <a class="dropdown-item" href="../articles/data.html">Importing Data</a>
    <a class="dropdown-item" href="../articles/events.html">Transformation Events</a>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <a class="dropdown-item" href="../articles/generateCodeInR.html">Generate Model Code</a>
    <a class="dropdown-item" href="../articles/intermediateFiles.html">Advantages of Intermediates</a>
    <a class="dropdown-item" href="../articles/ODE-Model.html">ODE Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Paremeter estimation and uncertainty quantification</h6>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Sensitivity Analysis</h6>
    <a class="dropdown-item" href="../articles/GSA.html">Global Sensitivity Analysis</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAR4</h6>
    <a class="dropdown-item" href="../articles/simAKAR4stochastic.html">Simulate AKAR4 stochastically</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4stochastic.html">Calibrate stochasic AKAR4</a>
    <a class="dropdown-item" href="../articles/GSA_AKAR4.html">GSA on AKAR4</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAP79</h6>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CaMKII</h6>
    <a class="dropdown-item" href="../articles/smmala.html">Calibrate CaMKII with SMMALA</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extra</h6>
    <a class="dropdown-item" href="../articles/extraExamples.html">More examples...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Build your own Model</h1>
            
      
      
      <div class="d-none name"><code>user_model.Rmd</code></div>
    </div>

    
    
<p>In this article we will assume that you have a model that you want to
work on and that you have written the model in SBtab form. It may be a
google spreadsheet, an open document spreadsheet (<code>ods</code>), MS
Excel file, a file for the <code>numbers</code> application on an Apple
device or a <code>.gnumeric</code> file.</p>
<p>There are three steps we need to make:</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="48%">
<col width="16%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th align="right"></th>
<th align="left">Steps</th>
<th align="center">file (out)</th>
<th align="center">tl;dr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">convert SBtab to ODE</td>
<td align="center">.vf</td>
<td align="center">biology =&gt; math</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">convert the ODE to sources</td>
<td align="center">.c</td>
<td align="center">math =&gt; code</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">convert sources to shared library</td>
<td align="center">.so</td>
<td align="center">code =&gt; machine code</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/icpm-kth/RPN-derivative" class="external-link">RPN-derivative</a>
calculates derivatives or offloads that work on maxima or yacas, install
them if you want to use the <code>--maxima</code> or
<code>--yacas</code> options.</p>
<div class="section level2">
<h2 id="load-the-tsv-files-convert-and-compile-the-model">Load the TSV files Convert and Compile the Model<a class="anchor" aria-label="anchor" href="#load-the-tsv-files-convert-and-compile-the-model"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SBtabVFGEN</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find the tsv files with "?dir", in the directory of your model</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">Location</span>,pattern<span class="op">=</span><span class="st">'tsv$'</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># you don't need this 'Location' variable, just be in the directory where the TSV files are.</span></span>
<span><span class="va">sb</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>                  <span class="co"># a list of data.frames</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_to_vfgen.html" class="external-link">sbtab_to_vfgen</a></span><span class="op">(</span><span class="va">sb</span><span class="op">)</span>                 <span class="co"># conservation laws, if any</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab.data.html" class="external-link">sbtab.data</a></span><span class="op">(</span><span class="va">sb</span>,<span class="va">cl</span><span class="op">)</span>                  <span class="co"># includes the data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sb</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2</a></span><span class="op">(</span><span class="st">"ode"</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-C"</span>, <span class="st">"--maxima"</span> ,<span class="st">"AKAR4cl.tar.gz"</span><span class="op">)</span>, stdout<span class="op">=</span><span class="st">"AKAR4cl_gvf.c"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"AKAR4cl_gvf.c"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">modelName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkModel.html">checkModel</a></span><span class="op">(</span><span class="st">"AKAR4cl"</span>,<span class="st">"AKAR4cl_gvf.c"</span><span class="op">)</span> <span class="co"># compiles the model if not yet compiled</span></span></code></pre></div>
<p>This should produce this output:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SBtabVFGEN</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find the tsv files with "?dir", in the directory of your model</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">Location</span>,pattern<span class="op">=</span><span class="st">'tsv$'</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># you don't need this 'Location' variable, just be in the directory where the TSV files are.</span></span>
<span><span class="va">sb</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>                  <span class="co"># a list of data.frames</span></span>
<span><span class="co">#&gt; [tsv] file[1] «100nM.tsv» belongs to Document «AKAR4cl»</span></span>
<span><span class="co">#&gt;  I'll take this as the Model Name.</span></span>
<span><span class="co">#&gt; 100nM.tsv  25nM.tsv  400nM.tsv  Compound.tsv  Experiments.tsv  Output.tsv  Parameter.tsv  Reaction.tsv</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_to_vfgen.html" class="external-link">sbtab_to_vfgen</a></span><span class="op">(</span><span class="va">sb</span><span class="op">)</span>                 <span class="co"># conservation laws, if any</span></span>
<span><span class="co">#&gt; Document Name: AKAR4cl.</span></span>
<span><span class="co">#&gt; SBtab has 8 tables.</span></span>
<span><span class="co">#&gt; The names of SBtab[[1]]:</span></span>
<span><span class="co">#&gt; !Time, &gt;AKAR4pOUT, ~AKAR4pOUT</span></span>
<span><span class="co">#&gt;                 !Name                             !KineticLaw</span></span>
<span><span class="co">#&gt; reaction_1 reaction_1 kf_C_AKAR4*C*AKAR4 - kb_C_AKAR4*AKAR4_C</span></span>
<span><span class="co">#&gt; reaction_2 reaction_2                      kcat_AKARp*AKAR4_C</span></span>
<span><span class="co">#&gt;                  !ReactionFormula !IsReversible</span></span>
<span><span class="co">#&gt; reaction_1  C + AKAR4 &lt;=&gt; AKAR4_C             1</span></span>
<span><span class="co">#&gt; reaction_2 AKAR4_C &lt;=&gt; AKAR4p + C             0</span></span>
<span><span class="co">#&gt; There is no «Constant» Table in this model. This is OK.</span></span>
<span><span class="co">#&gt; There is no «Expression» Table in this model. This is OK.</span></span>
<span><span class="co">#&gt; compound names:</span></span>
<span><span class="co">#&gt; [1] "AKAR4"   "AKAR4_C" "AKAR4p"  "C"</span></span>
<span><span class="co">#&gt; Units:</span></span>
<span><span class="co">#&gt; [1] "micromole/liter" "micromole/liter" "micromole/liter" "micromole/liter"</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; There is no «Input» Table in this model.</span></span>
<span><span class="co">#&gt; class(IsConstant): logical.</span></span>
<span><span class="co">#&gt; [1] Formula Unit   </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; [1] Formula Unit   </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; character(0)</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; character</span></span>
<span><span class="co">#&gt; Reaction 1:line (a-&gt;b): «C + AKAR4 » ←→ « AKAR4_C»</span></span>
<span><span class="co">#&gt;  where a: [1] "C "      " AKAR4 "</span></span>
<span><span class="co">#&gt;    and b: [1] " AKAR4_C"</span></span>
<span><span class="co">#&gt; Products:</span></span>
<span><span class="co">#&gt; 1 × AKAR4_C          (AKAR4_C is compound 2)</span></span>
<span><span class="co">#&gt; Reactants:</span></span>
<span><span class="co">#&gt; 1 × C            (C is compound 4)</span></span>
<span><span class="co">#&gt; 1 × AKAR4            (AKAR4 is compound 1)</span></span>
<span><span class="co">#&gt; Reaction 2:line (a-&gt;b): «AKAR4_C » ←→ « AKAR4p + C»</span></span>
<span><span class="co">#&gt;  where a: [1] "AKAR4_C "</span></span>
<span><span class="co">#&gt;    and b: [1] " AKAR4p " " C"      </span></span>
<span><span class="co">#&gt; Products:</span></span>
<span><span class="co">#&gt; 1 × AKAR4p           (AKAR4p is compound 3)</span></span>
<span><span class="co">#&gt; 1 × C            (C is compound 4)</span></span>
<span><span class="co">#&gt; Reactants:</span></span>
<span><span class="co">#&gt; 1 × AKAR4_C          (AKAR4_C is compound 2)</span></span>
<span><span class="co">#&gt; Number of compounds: 4</span></span>
<span><span class="co">#&gt; Number of Reactions: 2</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    1</span></span>
<span><span class="co">#&gt; [2,]    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1</span></span>
<span><span class="co">#&gt; [4,]    1   -1</span></span>
<span><span class="co">#&gt; Stoichiometric Matrix:</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]   -1    0</span></span>
<span><span class="co">#&gt; [2,]    1   -1</span></span>
<span><span class="co">#&gt; [3,]    0    1</span></span>
<span><span class="co">#&gt; [4,]   -1    1</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Conservation Law dimensions: 4 × 2</span></span>
<span><span class="co">#&gt; To check that the conservation laws apply: norm(t(StoichiometryMatrix) * ConservationLaw == 0.00000)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    0    1</span></span>
<span><span class="co">#&gt; [2,]    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    1</span></span>
<span><span class="co">#&gt; [4,]    1   -1</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; [1] 0 1 0 1</span></span>
<span><span class="co">#&gt; [1] 0.2 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 1*AKAR4_C+1*C</span></span>
<span><span class="co">#&gt; This will comment out compound 2 («AKAR4_C», initial value: 0), Conserved Constant = 0.000000</span></span>
<span><span class="co">#&gt; [1]  1  0  1 -1</span></span>
<span><span class="co">#&gt; [1] 0.2 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 1*AKAR4+1*AKAR4p-1*C</span></span>
<span><span class="co">#&gt; This will comment out compound 1 («AKAR4», initial value: 0.2), Conserved Constant = 0.200000</span></span>
<span><span class="co">#&gt; Loading required package: hdf5r</span></span>
<span><span class="co">#&gt; StateVariable AKAR4 will be commented out as it was already defined as a Mass Conservation Law Expression.StateVariable AKAR4_C will be commented out as it was already defined as a Mass Conservation Law Expression.</span></span>
<span><span class="co">#&gt; The vf content was written to: AKAR4cl.vf</span></span>
<span><span class="co">#&gt; MOD: StateVariable AKAR4 will be commented out as it was already defined as a Mass Conservation Law Expression.</span></span>
<span><span class="co">#&gt; MOD: StateVariable AKAR4_C will be commented out as it was already defined as a Mass Conservation Law Expression.</span></span>
<span><span class="co">#&gt; The mod content was written to: AKAR4cl.mod</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab.data.html" class="external-link">sbtab.data</a></span><span class="op">(</span><span class="va">sb</span>,<span class="va">cl</span><span class="op">)</span>                  <span class="co"># includes the data</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2</a></span><span class="op">(</span><span class="st">"ode"</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-C"</span>, <span class="st">"--maxima"</span> ,<span class="st">"AKAR4cl.tar.gz"</span><span class="op">)</span>, stdout<span class="op">=</span><span class="st">"AKAR4cl_gvf.c"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"AKAR4cl_gvf.c"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">modelName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkModel.html">checkModel</a></span><span class="op">(</span><span class="st">"AKAR4cl"</span>,<span class="st">"AKAR4cl_gvf.c"</span><span class="op">)</span> <span class="co"># compiles the model if not yet compiled</span></span>
<span><span class="co">#&gt; building a shared library from c source, and using GSL odeiv2 as backend (pkg-config is used here).</span></span>
<span><span class="co">#&gt; cc -shared -fPIC `pkg-config --cflags gsl` -o './AKAR4cl.so' 'AKAR4cl_gvf.c' `pkg-config --libs gsl`</span></span></code></pre></div>
<hr>
<p>We have created the c source code, with these functions:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">grep</span> AKAR4cl_ ./AKAR4cl_gvf.c</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_vf(double t, const double y_[], double f_[], void *par)</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_netflux(double t, double y_[], double *flux, void *par){</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_fwdflux(double t, double y_[], double *flux, void *par){</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_bwdflux(double t, double y_[], double *flux, void *par){</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_jac(double t, const double y_[], double *jac_, double *dfdt_, void *par)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_jacp(double t, const double y_[], double *jacp_, double *dfdt_, void *par)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_func(double t, const double y_[], double *func_, void *par)</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_funcJac(double t, const double y_[], double *funcJac_, void *par)</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_funcJacp(double t, const double y_[], double *funcJacp_, void *par)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_default(double t, void *par)</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; int AKAR4cl_init(double t, double *y_, void *par)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate">Simulate<a class="anchor" aria-label="anchor" href="#simulate"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## we create a closure called "sim" a function that internally remembers the "experiments" (ex)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulator.c.html">simulator.c</a></span><span class="op">(</span><span class="va">ex</span>,<span class="va">modelName</span><span class="op">)</span>                   <span class="co"># ex holds the instructions for the solver</span></span>
<span><span class="co">#&gt; Loading required package: rgsl</span></span>
<span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">sb</span><span class="op">$</span><span class="va">Parameter</span><span class="op">[[</span><span class="st">"!DefaultValue"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  <span class="co"># one column - but can be several sets (as columns)</span></span>
<span></span>
<span><span class="co">## sim can be called with any parameter vector - or several and will always simulate the same set of experiments</span></span>
<span><span class="va">sr</span> <span class="op">&lt;-</span> <span class="fu">sim</span><span class="op">(</span><span class="va">par</span><span class="op">)</span>                                     <span class="co"># simulation results (one per experiment)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sr</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="va">ex</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputTimes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">ex</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputValues</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="va">dy</span> <span class="op">&lt;-</span> <span class="va">ex</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">errorValues</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">sr</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">func</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>                           <span class="co"># third dimension is the par column (just one here)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">z</span>,bty<span class="op">=</span><span class="st">'n'</span>,type<span class="op">=</span><span class="st">'l'</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>,<span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span>,<span class="va">t</span>,<span class="va">y</span><span class="op">+</span><span class="va">dy</span>,angle<span class="op">=</span><span class="fl">90</span>, length<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span>,<span class="va">t</span>,<span class="va">y</span><span class="op">-</span><span class="va">dy</span>,angle<span class="op">=</span><span class="fl">90</span>, length<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"simulation"</span>,<span class="st">"data"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="user_model_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The simulation result <code>sr</code> is a list with several
components, at least 2: - <code>state</code> state variable trajectories
- <code>func</code> outout functions</p>
<p>The output functions usually correspond to the data (in some way),
but may need some sort of normalization. In this case the relationship
is direct.</p>
<p>Both <code>state</code> and <code>func</code> have three indexes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr</span><span class="op">[[</span><span class="va">l</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">k</span><span class="op">]</span>        <span class="co"># is a number</span></span></code></pre></div>
<p>This corresponds to experiment <code>l</code>, state variable
<code>i</code>, time-point <code>j</code>, and parameter column
<code>k</code> (again, relevant when <code>par</code> is a matrix with
multiple columns).</p>
<hr>
<p>The previously created <code>modelName</code> variable has a comment
attribute (that you can also set yourself, there is no magic there),
this attribute inidicates the location of the shared library used for
simulations. You don’t have to re-make it evry time - as long as the
model doesn’t change (<code>checkModel</code> does not need to be
called):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">modelName</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"./AKAR4cl.so"</span> <span class="co"># this is sufficient if the .so file already exists</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulations-of-several-parameter-sets">Simulations of Several Parameter Sets<a class="anchor" aria-label="anchor" href="#simulations-of-several-parameter-sets"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ex</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputTimes</span><span class="op">)</span></span>
<span><span class="va">np</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="va">REPS</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">np</span><span class="op">*</span><span class="va">REPS</span>,min<span class="op">=</span><span class="fl">0</span>,max<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>,<span class="va">np</span>,<span class="va">REPS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  3 50</span></span>
<span></span>
<span></span>
<span><span class="va">stm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sr</span> <span class="op">&lt;-</span> <span class="fu">sim</span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span><span class="va">etm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">etm</span>,<span class="va">stm</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 0.2752998 secs</span></span></code></pre></div>
<p>let’s plot all trajectories in one picture:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">t</span>,<span class="cn">NA</span><span class="op">)</span>,<span class="va">REPS</span><span class="op">)</span>                                  <span class="co"># the NA value will break the line</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sr</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">func</span><span class="op">[</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,<span class="cn">NA</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>    <span class="co"># at the end, so it doesn't loop</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">T</span>,<span class="va">Z</span>,type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></span></code></pre></div>
<p><img src="user_model_files/figure-html/Plots-1.png" width="700"></p>
<p>The new result is (just like the old one) an array with three
indexes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr</span><span class="op">[[</span><span class="va">l</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">func</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">k</span><span class="op">]</span> <span class="co"># a number</span></span></code></pre></div>
<ul>
<li>
<code>i</code> output function</li>
<li>
<code>j</code> time index</li>
<li>
<code>k</code> selects the trajectories that belong to
<code>P[,k]</code>
</li>
</ul>
<hr>
<p>cleanup:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"AKAR4cl%s"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".vf"</span>,<span class="st">".tar.gz"</span>,<span class="st">".zip"</span>,<span class="st">".so"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AKAR4cl.vf"     "AKAR4cl.tar.gz" "AKAR4cl.zip"    "AKAR4cl.so"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="va">gf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-formats">Other Formats<a class="anchor" aria-label="anchor" href="#other-formats"></a>
</h2>
<p>The SBtab content can be a normal spreadsheet.</p>
<p>If it is a google spreadsheet (which can be good for collaborative
work), you should write it until failry satisfied with all components
and then export it as an <code>.xlsx</code>, or <code>.ods</code> file.
The gnumeric application can automatically convert both
<code>.xlsx</code> and <code>.ods</code> to a set of <code>.tsv</code>
files if you want the benefits of version control (which works on text
files). But, <code>.ods</code> and <code>.xlsx</code> both work:</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_ods.html" class="external-link">SBtabVFGEN::sbtab_from_ods</a></code> for ODS files</li>
<li>
<code><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_excel.html" class="external-link">SBtabVFGEN::sbtab_from_excel</a></code> for XLSX files</li>
</ul>
<p>Our scripts find the tables by name:</p>
<ul>
<li>TSV files: <code>TableName</code> attribute is the name of the
table</li>
<li>ODS files: the Sheet’s name is the name of the table,
<code>TableName</code> attribute is not parsed</li>
<li>Excel files: the Sheet’s name (same as ODS)</li>
</ul>
<div class="section level3">
<h3 id="tab-separated-values">Tab Separated Values<a class="anchor" aria-label="anchor" href="#tab-separated-values"></a>
</h3>
<p>For more information on how to solve common tasks regarding tsv
files, see the <a href="./tsv.html">tsv topic</a>. We obtain a list of
all tsv files in the current directory, and then import the contents,
like this:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">'[.]tsv$'</span><span class="op">)</span></span>
<span><span class="va">SBtab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">modelFiles</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="open-document-spreadsheet">Open Document Spreadsheet<a class="anchor" aria-label="anchor" href="#open-document-spreadsheet"></a>
</h3>
<p>These files can be created with Libre Office, Apple’s
<em>numbers</em> program, gnumeric, and any web-hosted spreadsheet
application (like google spreadsheets).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFiles</span> <span class="op">&lt;-</span> <span class="st">"DemoModel.ods"</span></span>
<span><span class="va">SBtab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_ods.html" class="external-link">sbtab_from_ods</a></span><span class="op">(</span><span class="va">modelFiles</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="excel">Excel<a class="anchor" aria-label="anchor" href="#excel"></a>
</h3>
<p>These can be created with MS Excel, and loaded like this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFiles</span> <span class="op">&lt;-</span> <span class="st">"DemoModel.xlsx"</span></span>
<span><span class="va">SBtab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_excel.html" class="external-link">sbtab_from_excel</a></span><span class="op">(</span><span class="va">modelFiles</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h4>
<p>The R code generated by <code>ode.sh</code> includes a list with the
same functions, but with generic function names:</p>
<ul>
<li>
<code>model$vf()</code> vector field</li>
<li>
<code>model$jac()</code> Jacobian</li>
<li>
<code>model$init()</code> initial values</li>
<li>
<code>model$par()</code> default parameters in linear scale
<ul>
<li>regardless of what the scale was in the SBtab file</li>
<li>this function returns the long parameter vector (Parameter and
Input)</li>
</ul>
</li>
</ul>
<p>Observe that <code>model$par()</code> returns the ODE model
parameters, which can be more than the biological parameters, the
components are:</p>
<ul>
<li>biological parameters (<code>SBtab$Parameter</code>)</li>
<li>origignal input parameters (<code>SBtab$Input</code>)</li>
<li>derived input parameters, from conservationlaws (conserved
constants)</li>
</ul>
<p>The inputs are allowed to be different for each experiment (by
definition), the biological parameters are the same for all experiments
simulated in one go. Therefore, we only supply the biological parameters
(the first <code>n</code>) to the simultor and it retrieves the others
from the <code>experiments</code> variable, by concatenation:</p>
<p>Usually, the number of leading parameters
(sb$Parameter[[“!DefaultValue”]]) does not change. This is all the
simulator needs as the inputs are already in <code>ex</code>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
