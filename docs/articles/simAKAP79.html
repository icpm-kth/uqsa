<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>Example Simulation • uqsa</title>
<script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example Simulation">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/installExplanations.html">Explanation for System Prerequisites</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing Models</a>
    <a class="dropdown-item" href="../articles/data.html">Importing Data</a>
    <a class="dropdown-item" href="../articles/events.html">Transformation Events</a>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <a class="dropdown-item" href="../articles/generateCodeInR.html">Generate Model Code</a>
    <a class="dropdown-item" href="../articles/intermediateFiles.html">Advantages of Intermediates</a>
    <a class="dropdown-item" href="../articles/ODE-Model.html">ODE Model</a>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a Model</a>
    <a class="dropdown-item" href="../articles/GSA.html">Global Sensitivity Analysis</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAR4</h6>
    <a class="dropdown-item" href="../articles/simAKAR4.html">Simulate deterministic AKAR4</a>
    <a class="dropdown-item" href="../articles/simAKAR4stochastic.html">Simulate stochastic AKAR4</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4.html">UQ on deterministic AKAR4</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4mpi.html">UQ on deterministic AKAR4 with MPI</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4stochastic.html">UQ on stochasic AKAR4</a>
    <a class="dropdown-item" href="../articles/GSA_AKAR4.html">GSA on AKAR4</a>
    <a class="dropdown-item" href="../articles/UQSA_AKAR4.html">UQ and SA on AKAR4</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAP79</h6>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CaMKII</h6>
    <a class="dropdown-item" href="../articles/smmala.html">Calibrate CaMKII with SMMALA</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extra</h6>
    <a class="dropdown-item" href="../articles/extraExamples.html">More examples...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example Simulation</h1>
            
      
      
      <div class="d-none name"><code>simAKAP79.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">SBtabVFGEN</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: SBtabVFGEN</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span></code></pre></div>
<p>This article provides code to simulate the AKAP79 model (one time, no
sampling). We are plotting the model with default parameters which are
not expected to fit the data (this is the starting point).</p>
<div class="section level2">
<h2 id="load-the-model">Load the Model<a class="anchor" aria-label="anchor" href="#load-the-model"></a>
</h2>
<p>This model is included with the package. To load your own model, see
the <a href="user_model.html">user model</a> article.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">"AKAP79"</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">SBtab</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">modelFiles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [tsv] file[1] «AKAP79_Compound.tsv» belongs to Document «AKAP79»</span></span>
<span><span class="co">#&gt;  I'll take this as the Model Name.</span></span>
<span><span class="co">#&gt; AKAP79_Compound.tsv  AKAP79_Experiments.tsv  AKAP79_Expression.tsv  AKAP79_Input.tsv  AKAP79_Output.tsv  AKAP79_Parameter.tsv  AKAP79_Reaction.tsv  X0uM_cAMPCaN_AKAP79_0_nM_cAMP.tsv  X0uM_cAMPCaN_only_0_nM_cAMP.tsv  X0uM_cAMPno_CaN_0_nM_cAMP.tsv  X1000nM_cAMPCaN_AKAP79_1_uM_cAMP.tsv  X1000nM_cAMPCaN_only_1_uM_cAMP.tsv  X1000nM_cAMPno_CaN_1_uM_cAMP.tsv  X100nM_cAMPCaN_AKAP79_100_nM_cAMP.tsv  X100nM_cAMPCaN_only_100_nM_cAMP.tsv  X100nM_cAMPno_CaN_100_nM_cAMP.tsv  X2000nM_cAMPCaN_AKAP79_2_uM_cAMP.tsv  X2000nM_cAMPCaN_only_2_uM_cAMP.tsv  X2000nM_cAMPno_CaN_2_uM_cAMP.tsv  X200nM_cAMPCaN_AKAP79_200_nM_cAMP.tsv  X200nM_cAMPCaN_only_200_nM_cAMP.tsv  X200nM_cAMPno_CaN_200_nM_cAMP.tsv  X500nM_cAMPCaN_AKAP79_500_nM_cAMP.tsv  X500nM_cAMPCaN_only_500_nM_cAMP.tsv  X500nM_cAMPno_CaN_500_nM_cAMP.tsv</span></span>
<span><span class="va">modelName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkModel.html">checkModel</a></span><span class="op">(</span><span class="st">"AKAP79"</span>,<span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">"AKAP79"</span>,pat<span class="op">=</span><span class="st">"_gvf[.]c$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; building a shared library from c source, and using GSL odeiv2 as backend (pkg-config is used here).</span></span>
<span><span class="co">#&gt; cc -shared -fPIC `pkg-config --cflags gsl` -o './AKAP79.so' '/tmp/RtmpD5TwpL/temp_libpath3edc60164d35cf/uqsa/extdata/AKAP79/AKAP79_gvf.c' `pkg-config --libs gsl`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">modelName</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "./AKAP79.so"</span></span>
<span></span>
<span><span class="co"># model related functions, in R, e.g. AKAP79_default() parameters</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">"AKAP79"</span>,pat<span class="op">=</span><span class="st">'^AKAP79[.]R$'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">AKAP79_default</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            kf_Rii_C__RiiP_C kf_RiiP_CxcAMP__RiiP_C_cAMP </span></span>
<span><span class="co">#&gt;                    33.00000                     0.49600 </span></span>
<span><span class="co">#&gt; kf_RiiP_cAMPxC__RiiP_C_cAMP kb_RiiP_cAMPxC__RiiP_C_cAMP </span></span>
<span><span class="co">#&gt;                     0.00545                     0.01560 </span></span>
<span><span class="co">#&gt;     kb_RiiPXcAMP__RiiP_cAMP     kf_RiiPXcAMP__RiiP_cAMP </span></span>
<span><span class="co">#&gt;                     0.00160                     0.01500 </span></span>
<span><span class="co">#&gt;           kf_RiiPxC__RiiP_C           kb_RiiPxC__RiiP_C </span></span>
<span><span class="co">#&gt;                     0.03800                     0.00260 </span></span>
<span><span class="co">#&gt;       kf_cAMPxRii__Rii_cAMP       kb_cAMPxRii__Rii_cAMP </span></span>
<span><span class="co">#&gt;                     0.01500                     0.00160 </span></span>
<span><span class="co">#&gt;   kf_Rii_CxcAMP__Rii_C_cAMP   kb_Rii_CxcAMP__Rii_C_cAMP </span></span>
<span><span class="co">#&gt;                     0.49600                     1.41300 </span></span>
<span><span class="co">#&gt;             kf_RiixC__Rii_C   kf_Rii_cAMPxC__Rii_C_cAMP </span></span>
<span><span class="co">#&gt;                     2.10000                     0.29840 </span></span>
<span><span class="co">#&gt;   kb_Rii_cAMPxC__Rii_C_cAMP  kf_Rii_C_cAMP__RiiP_C_cAMP </span></span>
<span><span class="co">#&gt;                     0.01800                    33.00000 </span></span>
<span><span class="co">#&gt;             kb_RiixC__Rii_C                   AKAPoff_1 </span></span>
<span><span class="co">#&gt;                     0.00030                     2.60000 </span></span>
<span><span class="co">#&gt;                   AKAPoff_3                    AKAPon_1 </span></span>
<span><span class="co">#&gt;                    20.00000                     0.45000 </span></span>
<span><span class="co">#&gt;                    AKAPon_3                  kf_C_AKAR4 </span></span>
<span><span class="co">#&gt;                     2.00000                     0.01800 </span></span>
<span><span class="co">#&gt;                  kb_C_AKAR4                  kcat_AKARp </span></span>
<span><span class="co">#&gt;                     0.10600                    10.20000 </span></span>
<span><span class="co">#&gt;                       kmOFF                        kmON </span></span>
<span><span class="co">#&gt;                   100.00000                     1.00000 </span></span>
<span><span class="co">#&gt;                        KD_T                      b_AKAP </span></span>
<span><span class="co">#&gt;                     0.70000                     0.00000</span></span></code></pre></div>
<p>Conservation laws (determined by <code>sbtab_to_vfgen</code> and
saved as RDS file):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">"AKAP79"</span>,pat<span class="op">=</span><span class="st">'Laws[.]RDS$'</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">clf</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="va">cl</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>With conservation laws, some species are calculated algebraically.
Their initial values are turned into input parameters (using the found
law):</p>
<p>With this hypothetical relationship (<span class="math inline">\(c\)</span> is a constant):</p>
<p><span class="math display">\[A+B = c\,,\]</span></p>
<p>we can determine that</p>
<p><span class="math display">\[c = A_0 + B_0\,.\]</span></p>
<p>And thus we can replac either of the two species:</p>
<p><span class="math display">\[A(t) = A_0 + B_0 - B(t)\]</span></p>
<p>And <span class="math inline">\(A_0+B_0\)</span> are turned into an
input called <code>A_ConservedConst</code> (the <span class="math inline">\(c\)</span> above) with the value determined from
the stated initial condition.</p>
</div>
<div class="section level2">
<h2 id="load-experiments-data">Load Experiments (data)<a class="anchor" aria-label="anchor" href="#load-experiments-data"></a>
</h2>
<p>This also includes instructions for the simulator.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">experiments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab.data.html" class="external-link">sbtab.data</a></span><span class="op">(</span><span class="va">SBtab</span><span class="op">)</span> <span class="co"># with conservation laws</span></span>
<span><span class="co"># for example, these are the input</span></span>
<span><span class="co"># and initial state of experiment 1:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">experiments</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">input</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">experiments</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">initialState</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Rii          cAMP          RiiP         Rii_C     RiiP_cAMP </span></span>
<span><span class="co">#&gt;          6.30          0.00          0.00          0.63          0.00 </span></span>
<span><span class="co">#&gt;        RiiP_C   RiiP_C_cAMP             C      Rii_cAMP    Rii_C_cAMP </span></span>
<span><span class="co">#&gt;          0.00          0.00          0.00          0.00          0.00 </span></span>
<span><span class="co">#&gt;           CaN      RiiP_CaN RiiP_cAMP_CaN         AKAR4       AKAR4_C </span></span>
<span><span class="co">#&gt;          1.50          0.00          0.00          0.20          0.00 </span></span>
<span><span class="co">#&gt;        AKAR4p </span></span>
<span><span class="co">#&gt;          0.00</span></span>
<span><span class="co"># pick prameters for simulation</span></span>
<span><span class="va">nInput</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">experiments</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">input</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">nInput</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">AKAP79_default</span><span class="op">(</span><span class="op">)</span>,<span class="op">-</span><span class="va">nInput</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt;            kf_Rii_C__RiiP_C kf_RiiP_CxcAMP__RiiP_C_cAMP </span></span>
<span><span class="co">#&gt;                    33.00000                     0.49600 </span></span>
<span><span class="co">#&gt; kf_RiiP_cAMPxC__RiiP_C_cAMP kb_RiiP_cAMPxC__RiiP_C_cAMP </span></span>
<span><span class="co">#&gt;                     0.00545                     0.01560 </span></span>
<span><span class="co">#&gt;     kb_RiiPXcAMP__RiiP_cAMP     kf_RiiPXcAMP__RiiP_cAMP </span></span>
<span><span class="co">#&gt;                     0.00160                     0.01500 </span></span>
<span><span class="co">#&gt;           kf_RiiPxC__RiiP_C           kb_RiiPxC__RiiP_C </span></span>
<span><span class="co">#&gt;                     0.03800                     0.00260 </span></span>
<span><span class="co">#&gt;       kf_cAMPxRii__Rii_cAMP       kb_cAMPxRii__Rii_cAMP </span></span>
<span><span class="co">#&gt;                     0.01500                     0.00160 </span></span>
<span><span class="co">#&gt;   kf_Rii_CxcAMP__Rii_C_cAMP   kb_Rii_CxcAMP__Rii_C_cAMP </span></span>
<span><span class="co">#&gt;                     0.49600                     1.41300 </span></span>
<span><span class="co">#&gt;             kf_RiixC__Rii_C   kf_Rii_cAMPxC__Rii_C_cAMP </span></span>
<span><span class="co">#&gt;                     2.10000                     0.29840 </span></span>
<span><span class="co">#&gt;   kb_Rii_cAMPxC__Rii_C_cAMP  kf_Rii_C_cAMP__RiiP_C_cAMP </span></span>
<span><span class="co">#&gt;                     0.01800                    33.00000 </span></span>
<span><span class="co">#&gt;             kb_RiixC__Rii_C                   AKAPoff_1 </span></span>
<span><span class="co">#&gt;                     0.00030                     2.60000 </span></span>
<span><span class="co">#&gt;                   AKAPoff_3                    AKAPon_1 </span></span>
<span><span class="co">#&gt;                    20.00000                     0.45000 </span></span>
<span><span class="co">#&gt;                    AKAPon_3                  kf_C_AKAR4 </span></span>
<span><span class="co">#&gt;                     2.00000                     0.01800 </span></span>
<span><span class="co">#&gt;                  kb_C_AKAR4                  kcat_AKARp </span></span>
<span><span class="co">#&gt;                     0.10600                    10.20000 </span></span>
<span><span class="co">#&gt;                       kmOFF                        kmON </span></span>
<span><span class="co">#&gt;                   100.00000                     1.00000 </span></span>
<span><span class="co">#&gt;                        KD_T </span></span>
<span><span class="co">#&gt;                     0.70000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate">Simulate<a class="anchor" aria-label="anchor" href="#simulate"></a>
</h2>
<p>This will make a function <code>s</code>, which will always simulate
the scenarios described in the <code>experiments</code> list, but for
user supplied parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulator.c.html">simulator.c</a></span><span class="op">(</span><span class="va">experiments</span>,<span class="va">modelName</span>,noise<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: rgsl</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">s</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># which experiment to plot</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">experiments</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputValues</span><span class="op">$</span><span class="va">AKAR4pOUT</span></span>
<span><span class="va">err</span> <span class="op">&lt;-</span> <span class="va">experiments</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">errorValues</span><span class="op">$</span><span class="va">AKAR4pOUT</span></span>
<span><span class="va">tm</span> <span class="op">&lt;-</span> <span class="va">experiments</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputTime</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>bty<span class="op">=</span><span class="st">'n'</span>,xaxp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">120</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tm</span>,</span>
<span>     <span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">func</span><span class="op">[</span><span class="fl">1</span>,,<span class="fl">1</span><span class="op">]</span>,</span>
<span>     type<span class="op">=</span><span class="st">'l'</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>,<span class="fl">130</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"AKAR4p"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"t"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Experiment %i"</span>,<span class="va">E</span><span class="op">)</span>,</span>
<span>     lwd<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>     col<span class="op">=</span><span class="st">"purple"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">tm</span>,<span class="va">out</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span>x0<span class="op">=</span><span class="va">tm</span>,x1<span class="op">=</span><span class="va">tm</span>,y0<span class="op">=</span><span class="va">out</span>,y1<span class="op">=</span><span class="va">out</span><span class="op">+</span><span class="va">err</span>,angle<span class="op">=</span><span class="fl">90</span>,length<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span>x0<span class="op">=</span><span class="va">tm</span>,x1<span class="op">=</span><span class="va">tm</span>,y0<span class="op">=</span><span class="va">out</span>,y1<span class="op">=</span><span class="va">out</span><span class="op">-</span><span class="va">err</span>,angle<span class="op">=</span><span class="fl">90</span>,length<span class="op">=</span><span class="fl">0.025</span><span class="op">)</span></span></code></pre></div>
<p><img src="simAKAP79_files/figure-html/plotting-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="gg-plot">gg-Plot<a class="anchor" aria-label="anchor" href="#gg-plot"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span></span>
<span><span class="va">D</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">experiments</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputTime</span>,</span>
<span>              AKAR4p<span class="op">=</span><span class="va">experiments</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">outputValues</span><span class="op">$</span><span class="va">AKAR4pOUT</span>,</span>
<span>              AKAR4pERR<span class="op">=</span><span class="va">experiments</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">errorValues</span><span class="op">$</span><span class="va">AKAR4pOUT</span>,</span>
<span>              sim<span class="op">=</span><span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">func</span><span class="op">[</span><span class="fl">1</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,y<span class="op">=</span><span class="va">AKAR4p</span>,ymin<span class="op">=</span><span class="va">AKAR4p</span><span class="op">-</span><span class="va">AKAR4pERR</span>,ymax<span class="op">=</span><span class="va">AKAR4p</span><span class="op">+</span><span class="va">AKAR4pERR</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,y<span class="op">=</span><span class="va">AKAR4p</span><span class="op">)</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,y<span class="op">=</span><span class="va">sim</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"purple"</span>,lwd<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="simAKAP79_files/figure-html/ggplot-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
