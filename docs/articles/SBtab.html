<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>SBtab • uqsa</title>
<script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SBtab">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/installExplanations.html">Explanation for System Prerequisites</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Model and data management</h6>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing Models</a>
    <a class="dropdown-item" href="../articles/data.html">Importing Data</a>
    <a class="dropdown-item" href="../articles/events.html">Transformation Events</a>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <a class="dropdown-item" href="../articles/generateCodeInR.html">Generate Model Code</a>
    <a class="dropdown-item" href="../articles/intermediateFiles.html">Advantages of Intermediates</a>
    <a class="dropdown-item" href="../articles/ODE-Model.html">ODE Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Paremeter estimation and uncertainty quantification</h6>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Sensitivity Analysis</h6>
    <a class="dropdown-item" href="../articles/GSA.html">Global Sensitivity Analysis</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAR4</h6>
    <a class="dropdown-item" href="../articles/simAKAR4stochastic.html">Simulate AKAR4 stochastically</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4stochastic.html">Calibrate stochasic AKAR4</a>
    <a class="dropdown-item" href="../articles/GSA_AKAR4.html">GSA on AKAR4</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAP79</h6>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CaMKII</h6>
    <a class="dropdown-item" href="../articles/smmala.html">Calibrate CaMKII with SMMALA</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extra</h6>
    <a class="dropdown-item" href="../articles/extraExamples.html">More examples...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SBtab</h1>
            
      
      
      <div class="d-none name"><code>SBtab.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SBtabVFGEN</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rgsl</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span></code></pre></div>
<p>The R package <code>uqsa</code>, typically imports systems biology
models and corresponding data stored in <a href="https://www.sbtab.net" class="external-link">SBtab</a> files. SBtab is a table format
for system biology. The use of SBtab is optional, but very practical.
SBML models currently cannot be imported by this package, but can be
converted to SBtab using the online tools that <a href="https://www.sbtab.net" class="external-link">sbtab.net</a> provides. There could however
be minor features of SBML that are not supported by us, so the files are
not guaranteed to work here. SBtab files are user-friendly i.e. a human
can open SBtab files with a text editor and edit them manually.</p>
<p>An SBtab Document is a set of tables that contain the reactions,
compounds, parameters, etc of a model, and corresponding experimental
data that the model simulations should be able to reproduce. Different
experimental settings correspond in the model to different input
conditions, which are set by input parameters. The values of the input
parameters are always known, while the model’ s internal parameters
(e.g. reaction rate coefficients) can be subject to optimization or
sampling.</p>
<p>For the most part, in our case, an SBtab document is a collection of
<a href="https://en.wikipedia.org/wiki/Tab-separated_values" class="external-link">tsv</a>
files (has to be one file per table). This can be written by hand in a
plain text editor (one that doesn’t auto convert tabs to <em>N</em>
spaces) or in a spreadsheet (<a href="https://en.wikipedia.org/wiki/OpenDocument" class="external-link">ODS</a> or <a href="https://en.wikipedia.org/wiki/Microsoft_Excel" class="external-link">excel</a> ). The
tables contains information about the model, data, and their
relationship to one another:</p>
<ul>
<li>Reactions</li>
<li>Parameters</li>
<li>Output Functions</li>
<li>Compounds/Molecular Species</li>
</ul>
<p>Each type of items (e.g. parameters) gets a TSV file
(e.g. <code>Parameter.tsv</code>), see our examples.</p>
<p>From these files you can automatically generate code to simulate the
system deterministically or stochastically in C or R and load the data
into R.</p>
<div class="section level2">
<h2 id="advantages-of-sbtab">Advantages of SBtab<a class="anchor" aria-label="anchor" href="#advantages-of-sbtab"></a>
</h2>
<p>In SBtab, data and models are tightly linked as they contained in the
same document. For uqsa we also require that two tables on the
relationships between the experimental data and model simulations
exists:</p>
<ol style="list-style-type: decimal">
<li>
<em>Experiments</em>, where each row describes a different
experiment, providing individual model settings (input conditions) and
the name of the table that contains the actual data points.</li>
<li>
<em>Output</em>, a list of output functions that correspond to
measurable values for this model.</li>
</ol>
<p>SBML level 2 lacks the ability to carry data with the model and also
lacks the vocabulary to define which parameters are <em>inputs</em> and
which are <em>model internal</em>. There is also no way to define an
<em>observable</em> (output function) in SBML (a function that models
the measurement device, an observation). For this reason, an SBML
document cannot be converted into an SBtab document that has these
qualities (which we need). But, we may be wrong about what SBML can and
cannot do. Future versions of SBML may of course add new features.</p>
</div>
<div class="section level2">
<h2 id="sbtab-file-structure">SBtab File Structure<a class="anchor" aria-label="anchor" href="#sbtab-file-structure"></a>
</h2>
<p>Each file has a header, with attributes <code>key='value'</code>
separated by spaces or tabs, e.g.:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">!!SBtab</span> SBtabVersion=<span class="st">'1.0'</span> TableName=<span class="st">'Reaction'</span> TableType=<span class="st">'Reaction'</span> Document=<span class="st">'AKAP79'</span></span></code></pre></div>
<p>This header doesn’t have columns, it’s a line of text, immediately
followed by the actual table. In the sections below, we specify the
header like above and then give an example table that can follow this
header. You can also include other columns in any order; only some
column names have special meanings, unknown columns will not be parsed
(they are harmless).</p>
<p>At the moment we only parse two attribute of the header these are
<code>TableName</code> and <code>Document</code>.</p>
<dl>
<dt>Document</dt>
<dd>
must be the same string for all tables. We don’t check this. We use this
attribute to assign a name to the loaded model.
</dd>
<dt>TableType</dt>
<dd>
(does not matter) There are two generic table-types that can be used if
no specific one is applicable: <code>TableType='Quantity'</code> and
<code>TableType='QuantityMatrix'</code>. We don’t use the
<code>TableType</code> property at all, but it is needed for the
official (<a href="www.sbtab.net">sbtab.net</a>) tool-set to work.
</dd>
<dt>TableName</dt>
<dd>
Some Tables have a pre-determined name, e.g. <code>Reaction</code>, or
<code>Compound</code>. These are found by name, case sensitive spelling.
Other tables have to be mentioned somewhere to matter. An SBtab document
can have any number of data tables, these can have any name as long as
it is unique. The name of these tables has to be used as the experiment
ID. The function <code><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab.data.html" class="external-link">SBtabVFGEN::sbtab.data()</a></code> first reads the
table called <code>Experiments</code>, collects all IDs and then
searches for tables named like the experiment ID. The same mechanism is
used for Event Schedules.
</dd>
<dt>SBtabVersion</dt>
<dd>
ignored
</dd>
</dl>
<p>In the code snippet below the tables in tsv files of the AKAP79 model
are parsed into corresponding data frames in R:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">"AKAP79"</span><span class="op">)</span>          <span class="co"># this is what the directory is called</span></span>
<span><span class="va">sb</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span></span>
<span><span class="co">#&gt; [tsv] file[1] «AKAP79_Compound.tsv» belongs to Document «AKAP79»</span></span>
<span><span class="co">#&gt;  I'll take this as the Model Name.</span></span>
<span><span class="co">#&gt; AKAP79_Compound.tsv  AKAP79_Experiments.tsv  AKAP79_Expression.tsv  AKAP79_Input.tsv  AKAP79_Output.tsv  AKAP79_Parameter.tsv  AKAP79_Reaction.tsv  X0uM_cAMPCaN_AKAP79_0_nM_cAMP.tsv  X0uM_cAMPCaN_only_0_nM_cAMP.tsv  X0uM_cAMPno_CaN_0_nM_cAMP.tsv  X1000nM_cAMPCaN_AKAP79_1_uM_cAMP.tsv  X1000nM_cAMPCaN_only_1_uM_cAMP.tsv  X1000nM_cAMPno_CaN_1_uM_cAMP.tsv  X100nM_cAMPCaN_AKAP79_100_nM_cAMP.tsv  X100nM_cAMPCaN_only_100_nM_cAMP.tsv  X100nM_cAMPno_CaN_100_nM_cAMP.tsv  X2000nM_cAMPCaN_AKAP79_2_uM_cAMP.tsv  X2000nM_cAMPCaN_only_2_uM_cAMP.tsv  X2000nM_cAMPno_CaN_2_uM_cAMP.tsv  X200nM_cAMPCaN_AKAP79_200_nM_cAMP.tsv  X200nM_cAMPCaN_only_200_nM_cAMP.tsv  X200nM_cAMPno_CaN_200_nM_cAMP.tsv  X500nM_cAMPCaN_AKAP79_500_nM_cAMP.tsv  X500nM_cAMPCaN_only_500_nM_cAMP.tsv  X500nM_cAMPno_CaN_500_nM_cAMP.tsv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/comment.html" class="external-link">comment</a></span><span class="op">(</span><span class="va">sb</span><span class="op">)</span><span class="op">)</span>                   <span class="co"># the value of the Document attribute of f[1]</span></span>
<span><span class="co">#&gt; [1] "AKAP79"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sb</span><span class="op">)</span><span class="op">)</span>                     <span class="co"># the values of the TableName attributes</span></span>
<span><span class="co">#&gt;  [1] "Compound"                          "Experiments"                      </span></span>
<span><span class="co">#&gt;  [3] "Expression"                        "Input"                            </span></span>
<span><span class="co">#&gt;  [5] "Output"                            "Parameter"                        </span></span>
<span><span class="co">#&gt;  [7] "Reaction"                          "X0uM_cAMPCaN_AKAP79_0_nM_cAMP"    </span></span>
<span><span class="co">#&gt;  [9] "X0uM_cAMPCaN_only_0_nM_cAMP"       "X0uM_cAMPno_CaN_0_nM_cAMP"        </span></span>
<span><span class="co">#&gt; [11] "X1000nM_cAMPCaN_AKAP79_1_uM_cAMP"  "X1000nM_cAMPCaN_only_1_uM_cAMP"   </span></span>
<span><span class="co">#&gt; [13] "X1000nM_cAMPno_CaN_1_uM_cAMP"      "X100nM_cAMPCaN_AKAP79_100_nM_cAMP"</span></span>
<span><span class="co">#&gt; [15] "X100nM_cAMPCaN_only_100_nM_cAMP"   "X100nM_cAMPno_CaN_100_nM_cAMP"    </span></span>
<span><span class="co">#&gt; [17] "X2000nM_cAMPCaN_AKAP79_2_uM_cAMP"  "X2000nM_cAMPCaN_only_2_uM_cAMP"   </span></span>
<span><span class="co">#&gt; [19] "X2000nM_cAMPno_CaN_2_uM_cAMP"      "X200nM_cAMPCaN_AKAP79_200_nM_cAMP"</span></span>
<span><span class="co">#&gt; [21] "X200nM_cAMPCaN_only_200_nM_cAMP"   "X200nM_cAMPno_CaN_200_nM_cAMP"    </span></span>
<span><span class="co">#&gt; [23] "X500nM_cAMPCaN_AKAP79_500_nM_cAMP" "X500nM_cAMPCaN_only_500_nM_cAMP"  </span></span>
<span><span class="co">#&gt; [25] "X500nM_cAMPno_CaN_500_nM_cAMP"</span></span></code></pre></div>
<div class="section level3">
<h3 id="tabular-content">Tabular Content<a class="anchor" aria-label="anchor" href="#tabular-content"></a>
</h3>
<p>The second line/row contains the table column names, which often
start with an exclamation point, or another special character to signify
a special meaning. Do not copy paste the examples here, they are printed
using the <code>column</code> command, which alignes the columns of a
table using the appropriate number of spaces (so the printout is not tsv
anymore).</p>
<div class="section level4">
<h4 id="special-column-symbols-prefixes">Special Column Symbols (Prefixes)<a class="anchor" aria-label="anchor" href="#special-column-symbols-prefixes"></a>
</h4>
<ul>
<li>In <code>!abc</code>, ! means that this column has a special
meaning, defined in the SBtab standard</li>
<li>In <code>&gt;xyz</code>, &gt; means that this column specifies a
value for the variable <code>xyz</code> that has an entry in some other
table
<ul>
<li>there must be a table where <code>xyz</code> appears in the
<code>!ID</code> column,</li>
</ul>
</li>
<li>In <code>~xyz</code>, ~ means <em>standard error</em> – this is our
extension.<br>
We don’t know how to express this in plain SBtab
<ul>
<li>this column specifies the standard error for
<code>&gt;xyz</code>
</li>
<li>ultimately, the meaning of the values of this column are up to the
objective-function or likelihood-function. A <em>user supplied</em>
function can interpret this value in any way the user wishes.</li>
<li>If this value is NA or Inf, then the <code>&gt;xyz</code> values are
removed from the default likelihood functions as well.</li>
<li>An unknown standard error, <code>x ± NA</code>, or
<code>x ± Inf</code> are the same as <em>value unknown</em>; we discount
both cases.</li>
</ul>
</li>
<li>any column that doesn’t start with one of <code>!&gt;~</code> isn’t
special and isn’t interpreted by us.</li>
</ul>
<p>The first column is special. It can be called either <code>!ID</code>
or <code>!Name</code> (it is harmless to have both). If the first column
is not called that, the scripts will carry on regardless, assuming that
the first column contain some kind of names for the entries. So,
<code>!Id</code>, <code>!id</code>, or <code>ID?</code> will also work
for us – not for other software. All other columns are found by name
(case sensitive), they can appear in any order. Variables in reaction
rates and formulae are all <em>first column IDs</em> (regardless of
column label).</p>
</div>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<p>The set of columns are given as example tables in the following
Sections. An example of an SBtab file, in general, with header:</p>
<pre><code>!!SBtab Document='AKAP79' SBtabVersion='1.0' TableName='Reaction' TableTitle='Reactions in AKAP79 Model' TableType='Reaction'
!ID          !KineticLaw                                                                                    !ReactionFormula                   !IsReversible
reaction_51  kf_Rii_C__RiiP_C*Rii_C                                                                         Rii_C &lt;=&gt; RiiP_C                   0
reaction_14  kf_RiiPxC__RiiP_C*RiiP*C - kb_RiiPxC__RiiP_C*RiiP_C                                            RiiP + C &lt;=&gt; RiiP_C                1
reaction_12  kf_RiiP_CxcAMP__RiiP_C_cAMP*RiiP_C*cAMP - kb_RiiP_CxcAMP__RiiP_C_cAMP*RiiP_C_cAMP              RiiP_C + cAMP &lt;=&gt; RiiP_C_cAMP      1
reaction_43  kf_RiiPXcAMP__RiiP_cAMP*cAMP*RiiP - kb_RiiPXcAMP__RiiP_cAMP*RiiP_cAMP                          cAMP + RiiP &lt;=&gt; RiiP_cAMP          1
reaction_23  kf_RiiP_cAMPxC__RiiP_C_cAMP*RiiP_cAMP*C - kb_RiiP_cAMPxC__RiiP_C_cAMP*RiiP_C_cAMP              RiiP_cAMP + C &lt;=&gt; RiiP_C_cAMP      1
reaction_78  kf_cAMPxRii__Rii_cAMP*cAMP*Rii - kb_cAMPxRii__Rii_cAMP*Rii_cAMP                                cAMP + Rii &lt;=&gt; Rii_cAMP            1
reaction_56  kf_Rii_CxcAMP__Rii_C_cAMP*Rii_C*cAMP - kb_Rii_CxcAMP__Rii_C_cAMP*Rii_C_cAMP                    Rii_C + cAMP &lt;=&gt; Rii_C_cAMP        1
reaction_76  kf_Rii_cAMPxC__Rii_C_cAMP*Rii_cAMP*C - kb_Rii_cAMPxC__Rii_C_cAMP*Rii_C_cAMP                    Rii_cAMP + C &lt;=&gt; Rii_C_cAMP        1
reaction_62  kf_Rii_C_cAMP__RiiP_C_cAMP*Rii_C_cAMP                                                          Rii_C_cAMP &lt;=&gt; RiiP_C_cAMP         0
reaction_58  kf_RiixC__Rii_C*Rii*C - kb_RiixC__Rii_C*Rii_C                                                  Rii + C &lt;=&gt; Rii_C                  1
reaction_44  kf_RiiPxCaN__RiiP_CaN*RiiP*CaN - kb_RiiPxCaN__RiiP_CaN*RiiP_CaN                                RiiP + CaN &lt;=&gt; RiiP_CaN            1
reaction_33  kf_CaNxRiiP_cAMP__RiiP_cAMP_CaN*CaN*RiiP_cAMP - kb_CaNxRiiP_cAMP__RiiP_cAMP_CaN*RiiP_cAMP_CaN  CaN + RiiP_cAMP &lt;=&gt; RiiP_cAMP_CaN  1
reaction_48  kf_RiiP_CaN__RiixCaN*RiiP_CaN                                                                  RiiP_CaN &lt;=&gt; Rii + CaN             0
reaction_37  kf_RiiP_cAMP_CaN__CaNXRii_cAMP*RiiP_cAMP_CaN                                                   RiiP_cAMP_CaN &lt;=&gt; CaN + Rii_cAMP   0
reaction_1   kf_C_AKAR4*C*AKAR4 - kb_C_AKAR4*AKAR4_C                                                        C + AKAR4 &lt;=&gt; AKAR4_C              1
reaction_2   kcat_AKARp*AKAR4_C                                                                             AKAR4_C &lt;=&gt; AKAR4p + C             0</code></pre>
<p>The same file can look like this in spreadsheet software, e.g.<a href="http://www.gnumeric.org/" class="external-link">gnumeric</a>: <img src="AKAP79-Reaction.png" alt="AKAP79 Reaction Table"></p>
<p>Each variable mentioned here, e.g. <code>cAMP</code> is an ID of some
row in another table, <code>cAMP</code> is a compound and can be found
in <code>Compound.tsv</code>, named like that in the first column.</p>
<dl>
<dt>Note 1</dt>
<dd>
our code ignores almost everything in the first line, except
<code>TableName</code>
</dd>
<dt>Note 2</dt>
<dd>
<code>FALSE</code> and <code>TRUE</code> (the Boolean values lots of
spreadsheet software uses) mostly work in R correctly, they can also
work (literally) in C (if they are defined as macros or enums). Some
spreadsheet software exports <code>TRUE</code>/<code>FALSE</code> as
<code>1</code>/<code>0</code> into TSV (using 1/0 is usually better).
See the last Section on this page about this topic.
</dd>
</dl>
<p>If you are familiar with using the terminal window, you can use the
following code snippet to display an SBtab on screen (in the terminal)
with column alignment (but losing the tabstops):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 1 Reaction.tsv</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">tail</span> <span class="at">-n</span> +2 Reaction.tsv <span class="kw">|</span> <span class="ex">column</span> <span class="at">-t</span> <span class="at">-s</span> <span class="st">'    '</span></span></code></pre></div>
<p>All of the following examples are printed like that, with automatic
vertical alignment (spaces). You absolutely cannot copy paste them
directly into new files (there must be tabs separating the
words/values). Use the bundled example files directly (as
templates).</p>
</div>
<div class="section level4">
<h4 id="constant">Constant<a class="anchor" aria-label="anchor" href="#constant"></a>
</h4>
<p>A list of constants. These are values that never change for
<em>this</em> model, e.g. Avogadro’s number:</p>
<pre><code> !!SBtab  TableName='Constant'  Document='myModel' 
     !ID  !Unit                 !Value
       L  1                     6.02214076E+23
     ...  .....                 ..............</code></pre>
<p>The number of items in the first line is usually different from the
rest, as this is a header, so they don’t always form a neat table.</p>
<p>This also breaks the smart display of these files as tables on
github.</p>
</div>
<div class="section level4">
<h4 id="input">Input<a class="anchor" aria-label="anchor" href="#input"></a>
</h4>
<p>Known paramters of the model, can vary between experiments.</p>
<pre><code>!!SBtab TableName='Input' Document='myModel'
 !ID  !DefaultValue  !Unit   !Comment
 CaB  2000.0         nM      Calcium-Base-Level
 ...  ...            ...     ...</code></pre>
<p>Inputs are what distinguishes experiments alongside initial values,
and event schedules (interventions). These are default values. Other
values can be set in the line of each experiment in the experiment
table, e.g.:</p>
<pre><code>!!SBtab TableName='Experiment' Document='myModel'
!ID !Type        !Time  &gt;CaB    &gt;...
E1  Time Series  100    1700.0  ...
... ...........  .....  ......  ...</code></pre>
</div>
<div class="section level4">
<h4 id="parameter">Parameter<a class="anchor" aria-label="anchor" href="#parameter"></a>
</h4>
<p>Possibly unknown parameters of the model, these parameters typically
refer to internal properties of the model itself rather than something
we did to the model reflecting an experiment. Typically, these
parameters are the ones that are changed during a sampling process.</p>
<pre><code>!!SBtab TableName='Parameter' Document='myModel'
 !ID  !DefaultValue  !Std  !Unit     !Scale
 kf1            1.8   0.1  s^(-1)    natural logarithm 
 ...            ...  ...   ...       ...</code></pre>
<p>Here the <code>!Scale</code> column is optional, but often useful;
several values are possible:
<code>log10</code>,<code>log</code>,<code>linear</code> (in various
spellings). If missing, <code>linear</code> is assumed.</p>
</div>
<div class="section level4">
<h4 id="expression">Expression<a class="anchor" aria-label="anchor" href="#expression"></a>
</h4>
<p>Mathematical sub-expressions that can be used in reaction fluxes. Can
be used to encode thermodynamic relationships between parameters or to
model an input signal. This is used to assign a name (e.g. KD_1) to an
algebraic expression.</p>
<pre><code>!!SBtab TableName='Expression' Document='myModel'
  !ID  !Unit  !Formula
 KD_1  nM     (KD_3*KD_4)/KD_2
  ...  ...    ...</code></pre>
</div>
<div class="section level4">
<h4 id="compound">Compound<a class="anchor" aria-label="anchor" href="#compound"></a>
</h4>
<p>In SBML parlance, these are <em>species</em>.</p>
<pre><code>!!SBtab TableName='Compound' TableType='Compound' Document='myModel'
      !ID  !Unit  !InitialValue
 PP2B_CaM  μM     0.0
      ...  ...    ...</code></pre>
<p>There are several optional columns, e.g. <code>!IsConstant</code> and
<code>!Type</code>. These variables are usually used as state variables
in an ODE framework.</p>
</div>
<div class="section level4">
<h4 id="reaction">Reaction<a class="anchor" aria-label="anchor" href="#reaction"></a>
</h4>
<p>The Table of Reactions can be seen as the main piece of information
for the model.</p>
<pre><code>!!SBtab TableName='Reaction' TableType='Reaction' Document='myModel'
       !ID  !KineticLaw    !IsReversible   !ReactionFormula 
 Reaction1  kf*A*B - kb*C  TRUE            A + B &lt;=&gt; C
       ...  ...            ...             ...</code></pre>
<p>Both <code>KineticLaw</code> and <code>Formula</code> are required,
even though a kinetic law could be determined from the formula in a
pinch (mass action). We don’t infer kinetic laws in our code. The
reversibility of reactions is set via <code>!IsReversible</code> and can
be expressed via <code>TRUE</code>/<code>FALSE</code> or
<code>1</code>/<code>0</code>; this has no effect on the arrow in the
formula (as intended in the official SBtab documentation), there is no
one sided arrow.</p>
</div>
<div class="section level4">
<h4 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h4>
<p>Outputs are Observables. A function that can be related to measured
data.</p>
<pre><code>!!SBtab TableName='Output' Document='myModel'
      !ID  !Unit  !Formula
 CaPerCaM  1      totalCa/totalCaM
      ...  ...    ...</code></pre>
<p>A unit of <code>1</code> means the same as
<code>'dimensionless'</code> in SBML.</p>
<p>A function can be an inequality. If the experimental data has an
<em>allowed range</em> (min and max), rather than a standard error, then
this Output could be useful:</p>
<pre><code>!!SBtab TableName='Output' Document='myModel'
  !ID  !Unit  !Formula
    A  1      Ca/CaB
Bound  1      (A&lt;5000) &amp;&amp; (A&gt;1000)</code></pre>
<p>In the end, the model output A from a simulation will be compared
with a corresponding experimental data point for the observable A from a
data table. The data table could look like:</p>
<pre><code>!!SBtab [...]
!TimePoint !Time    &gt;A  ~A  &gt;Bound  ~Bound
        T1     0  1500  150   TRUE  0.1</code></pre>
<p>Data can be Boolean/<code>logical</code> (it’s alsways treated as
<code>1</code> or <code>0</code>). See also the Data Section further
down on this page.</p>
</div>
<div class="section level4">
<h4 id="experiments">Experiments<a class="anchor" aria-label="anchor" href="#experiments"></a>
</h4>
<pre><code>!!SBtab TableName='Experiments' Document='myModel'
               !ID  !Type          !Time  !T0    !Event              !Citation
    Smith2019Fig2E  Time Series    600.0  -100.0  EventScheduleAlpha  https//doi.org/10.[...] 
               ...  ...            ...    ...     ...                ...</code></pre>
<p><em>AuthorYear</em> citation keys make good ID values for data
sets.</p>
<p><code>!Type</code> is one of: <code>Time Series</code>, or
<code>Dose Response</code> for our purposes (possibly more types in the
future). All types are convenience features, Time Series is the basic
type that can do anything.</p>
<p>The initial time for the ODE, <span class="math inline">\(t_0\)</span>, corresponds to the beginning of the
experiment setup: <code>!T0</code> (the time value). The value of
<code>!Time</code> is the default time of measurements if none is given
in the data table. For dose response experiments, this is the only place
to specify the measurement time. <code>!Event</code> names the table
that contains the event schedule (a time sequence of named
transformations).</p>
<p>The <code>!Citation</code> column is entirely optional.</p>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>The experimental data is stored in TSV files as well, but isn’t used
when building the ODE code. It is used in parameter estimation. The data
table can have any name <code>XYZ</code> but usually something related
to the experiment. The data tables are refered to from the Experiment
table by having the ID <code>XYZ</code> on some row.</p>
<div class="section level5">
<h5 id="time-series">Time Series<a class="anchor" aria-label="anchor" href="#time-series"></a>
</h5>
<pre><code>!!SBtab Document='myModel' Version='1.0' TableName='Smith2019Fig2E' TableType='QuantityMatrix'          
!TimePoint  !Time  &gt;AKAR4pOUT  ~AKAR4pOUT
E0301T001   -15    99.4136     0.711886579917949
E0301T002   -10    100.617     0.401234567901235
E0301T003   -5     101.944     0.927467851933129
E0301T004   0      NA          NA
E0301T005   5      101.204     0.28287504289851
E0301T006   10     102.037     0.565750085797018
E0301T007   15     102.346     0.432098765432101
E0301T008   20     103.765     0.40478015582111
E0301T009   25     105.463     1.14280917170207
E0301T010   30     106.204     1.07316905251319
E0301T011   35     110.648     0.509960235859822
E0301T012   40     110.988     1.31417708987925
E0301T013   45     112.438     1.60137305815714</code></pre>
<p><code>!TimePoint</code> is a kind of <code>!ID</code>, our scripts do
not check what the first column is called, the contents are always used
as <code>rownames</code> in R data-frames. These ID’s are not used for
anything, currently.</p>
<p>In this particular Table, we find a missing value (was not
measured).</p>
</div>
<div class="section level5">
<h5 id="dose-response">Dose Response<a class="anchor" aria-label="anchor" href="#dose-response"></a>
</h5>
<p>In dose response experiments, the system reacts to an input dose
repeatedly. Each row is simulated as a time series by itself.</p>
<p>The table works the same way, but rather than <code>Time</code> we
have an input column:</p>
<pre><code>!!SBtab SBtabVersion='1.0' Document='CaMKIIs' TableName='Shifman2006Fig1Bsq' TableType='QuantityMatrix' 
!ID    &gt;Ca_set  &gt;CaPerCaM  ~CaPerCaM
E1D0   364      0.011      0.3985
E1D1   2305     1.196      0.3985
E1D2   2548     1.464      0.3985
E1D3   2912     1.743      0.3985
E1D4   3640     1.956      0.3985
E1D5   4126     2.09       0.3985
E1D6   3762     2.291      0.3985
E1D7   4611     2.38       0.3985
E1D8   4247     2.559      0.3985
E1D9   5461     2.604      0.3985
E1D10  4611     2.85       0.3985
E1D11  6067     2.917      0.3985
E1D12  5339     3.04       0.3985
E1D13  6796     3.163      0.3985
E1D14  6067     3.23       0.3985
E1D15  7281     3.465      0.3985
E1D16  8495     3.61       0.3985
E1D17  9344     3.856      0.3985
E1D18  24393    3.994      0.3985
E1D19  34101    3.996      0.3985</code></pre>
<p>Here <code>Ca_set</code> is an input value, and <code>CaPerCam</code>
is an output value. Which is Input or Output cannot be determined from
the Table itself, only from the rest of the SBtab Document. Each row can
be considered a mini time series, with one single measurement time each.
At which time the measurement shall occur is written in the table of
experiments, column <code>!Time</code> (the default measurement time). A
different time for each row is not possible (currently).</p>
</div>
</div>
<div class="section level4">
<h4 id="transformation-only-available-for-ode-models">Transformation (only available for ODE models)<a class="anchor" aria-label="anchor" href="#transformation-only-available-for-ode-models"></a>
</h4>
<p>A table of all possible transformations (maps) that are part of any
experiment’s described procedure. An event can trigger any of these
transformation at specific event-times.</p>
<pre><code>!!SBtab TableName='Transformation' Document='MyModel'
 !ID  &gt;A     &gt;B     &gt;C
 TF1  A-B    B      C
 TF2  A      B/2    C
 TF3  A*0.1  B*0.1  C*0.1 </code></pre>
<p>Here we see one transformation per line that affects the variables
listed in the column names <code>&gt;Var</code>, i.e.:</p>
<pre><code><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">-</span><span class="va">B</span>  <span class="co"># TF1</span></span>
<span><span class="va">...</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="va">B</span><span class="op">/</span><span class="fl">2</span>  <span class="co"># TF2</span></span>
<span><span class="va">...</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">*</span><span class="fl">0.1</span> <span class="co"># TF3</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="va">B</span><span class="op">*</span><span class="fl">0.1</span> <span class="co"># TF3</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="va">C</span><span class="op">*</span><span class="fl">0.1</span> <span class="co"># TF3</span></span>
<span><span class="va">...</span></span></code></pre>
<p>This is what would conceptually happen in the generated code (not
literally, as it actually happens in the C code).</p>
</div>
<div class="section level4">
<h4 id="event-only-availible-for-ode-models">Event (only availible for ODE models)<a class="anchor" aria-label="anchor" href="#event-only-availible-for-ode-models"></a>
</h4>
<p>Events will interrupt the ODE solver in the rgsl package (not other
solvers), change the values of input parameters, or state variables
according to the available named tranformations (see above). After the
transformation the solver is re-initialized to continue from there.</p>
<pre><code>!!SBtab TableName='EventScheduleAlpha' Document='myModel' 
  !TimePoint  !Time  !Tranformation 
 Event0Time0  10.0   TF1
 Event0Time0  11.0   TF2
         ...  ...    ...</code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="a-note-on-units">A Note on Units<a class="anchor" aria-label="anchor" href="#a-note-on-units"></a>
</h2>
<p>Units should be defined for every entity. This unit can be written in
a human readable conventional form (we don’t insist on it being
correct). It is mostly intended for human readers, but we do parse it
and use the information for SBML export.</p>
<p>You can test the unit parser like this:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prettyPrint</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"-"</span>,<span class="fl">12</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">u</span> <span class="kw">in</span> <span class="va">units</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s[%12s]%s\n"</span>,<span class="va">L</span>,<span class="va">u</span>,<span class="va">L</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/unit.from.string.html" class="external-link">unit.from.string</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">prettyPrint</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cm"</span>,<span class="st">"uM"</span>,<span class="st">"MM"</span>,<span class="st">"1"</span>,<span class="st">"μM"</span>,<span class="st">"nanomolarity"</span>,<span class="st">"s^-1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ------------[          cm]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent  kind</span></span>
<span><span class="co">#&gt; 1    -2          1        1 metre</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------[          uM]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent  kind</span></span>
<span><span class="co">#&gt; 1    -6          1        1  mole</span></span>
<span><span class="co">#&gt; 2     0          1       -1 litre</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------[          MM]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent  kind</span></span>
<span><span class="co">#&gt; 1     6          1        1  mole</span></span>
<span><span class="co">#&gt; 2     0          1       -1 litre</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------[           1]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent          kind</span></span>
<span><span class="co">#&gt; 1     0          1        1 dimensionless</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------[         μM]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent  kind</span></span>
<span><span class="co">#&gt; 1    -6          1        1  mole</span></span>
<span><span class="co">#&gt; 2     0          1       -1 litre</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------[nanomolarity]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent  kind</span></span>
<span><span class="co">#&gt; 1    -9          1        1  mole</span></span>
<span><span class="co">#&gt; 2     0          1       -1 litre</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------[        s^-1]------------</span></span>
<span><span class="co">#&gt;   scale multiplier exponent   kind</span></span>
<span><span class="co">#&gt; 1     0          1       -1 second</span></span></code></pre></div>
<p><strong>Units are not optional</strong></p>
<p>Dimensionless quantities are ok, e.g. Hill-exponents, the unit is
just <code>1</code> in such cases.</p>
<p>But, even though we do parse them, we currently don’t auto-convert
units: If a flux is <code>kf*a - kb*b</code>, then the units of
<code>kf</code>, <code>a</code>, <code>kb</code>, and <code>b</code>
have to be compatible, such that the unit of <code>kf*a</code> is the
same as <code>kb*b</code>. It is of course legal (in general) to
calculate <code>1 m + 1 cm</code>, but we don’t do this unit-conversion
automatically (maybe never will).</p>
<p>Although SBML has units as well the software support for units on the
SBML side is also not feature-complete in all cases. Other software may
have its own restrictions on possible units (or unit combinations).</p>
<p>COPASI wants all species to have the same unit of measurement. We
don’t make such restrictions.</p>
</div>
<div class="section level2">
<h2 id="issues-to-be-aware-of-with-any-file-format">Issues to be aware of with any File format<a class="anchor" aria-label="anchor" href="#issues-to-be-aware-of-with-any-file-format"></a>
</h2>
<p>Our <a href="icpm-kth/SBtabVFGEN">SBtabVFGEN</a> package uses either
multiple TSV files or one <a href="https://en.wikipedia.org/wiki/OpenDocument" class="external-link">ODS</a> (or <a href="https://en.wikipedia.org/wiki/Microsoft_Excel" class="external-link">excel</a> ) file.
The TSV reading is done using core R functions, while ODS is read
through <a href="https://cran.r-project.org/package=readODS" class="external-link">readODS</a>. Both
formats can have issues that are general and not specific to this
package:</p>
<ul>
<li>TSV
<ul>
<li>line endings can be <code>\n</code> or <code>\n\r</code>
</li>
<li>fields could be automatically and unnecessarily quoted by a
spreadsheet software</li>
<li>encoding (UTF-8, or something else)</li>
<li>some spreadsheets may want to write a unicode minus sign
<code>−</code> rather than <code>-</code> into a tsv file:
<code>U+2212</code> (vs ascii dash), be careful</li>
<li>lines can be blank, but not quite, if they contain just tabs or
spaces</li>
</ul>
</li>
<li>ODS
<ul>
<li>comments inside fields could be imported as field content and
confuse the model parser</li>
<li>same issue with unicode minus signs</li>
<li>
<code>readODS</code> could theoretically be discontinued
(deprecated), despite the format continuing to exist</li>
<li>all spreadsheet software comes with auto-correct and will correct
SBtab to Sbtab and probably also all of the unusual protein names (PKA
to Pka or similar)</li>
</ul>
</li>
</ul>
<p>Models can be automatically converted between the SBtab format and
other modelling formats (such as SBML). For more information about SBtab
please refer to <a href="https://github.com/tlubitz/SBtab" class="external-link">the official
git repository</a>.</p>
<p>Be aware that the conversion from SBML to SBtab has to be done with
the official SBtab tools, not ours (SBML is hard).</p>
</div>
<div class="section level2">
<h2 id="alternatives">Alternatives<a class="anchor" aria-label="anchor" href="#alternatives"></a>
</h2>
<p>A user can circumvent this entire format by just writing the C code
or R code for the model by hand or an entirely different tool, such as
<a href="https://warrenweckesser.github.io/vfgen/" class="external-link">VFGEN</a> itself, or
an SBML related project like <a href="https://www.ebi.ac.uk/biomodels/tools/converters/" class="external-link">SBFC</a> that
generates code. Or, if the model is small enough, you can also write
these files using a text editor without any other tool.</p>
<p>The data we load from SBtab files is stored as a list in R, each item
is itself a list of <code>data.frames</code> or vectors (it’s not a
black-box object). A user can just create such a list (e.g. in an R
script), if they want to avoid SBtab entirely. If the data is stored in
a different format, such as an hdf5 file, it could be read using
e.g. hdf5r and re-roganized into a list like this.</p>
<p>Ultimately, the code in uqsa expects a likelihood function or
objective-function that assigns a scalar value to a parameter vector,
what this function does to calculate it is up to every user.</p>
</div>
<div class="section level2">
<h2 id="note-on-boolean-values">Note on Boolean Values<a class="anchor" aria-label="anchor" href="#note-on-boolean-values"></a>
</h2>
<p>Special care has to be taken when the TSV files use TRUE and FALSE as
values. This is useful, because the data in the tables can refer to
inequality constraints.</p>
<p>Consider this:</p>
<pre><code>!!SBtab TableName='Output'
!ID      !Formula
a_lt_b   a &lt; b</code></pre>
<p>with an Experiment that checks this condition:</p>
<pre><code>!!SBtab TableName='Experiments'
              !ID  !T0  &gt;A  &gt;B  [...] % input settings, initial values
CheckInequalities  -1.0  12  13</code></pre>
<p>and this data table:</p>
<pre><code>!!SBtab TableName='CheckInequalities',
!TimePoint  !Time   &gt;a_lt_b,
        T1  0.00    TRUE
        T2  0.01    TRUE
        T3  0.03    FALSE</code></pre>
<p>This is perfectly fine.</p>
<p>Tests in R, to verify:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a dummy file:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"!!SBtab TableName='CheckInequalities'"</span>,</span>
<span><span class="st">"!TimePoint\t!Time\t&gt;a_lt_b"</span>,</span>
<span><span class="st">"T1\t0.00\tTRUE"</span>,</span>
<span><span class="st">"T2\t0.01\tTRUE"</span>,</span>
<span><span class="st">"T3\t0.03\tFALSE"</span>,</span>
<span>file<span class="op">=</span><span class="st">"test.tsv"</span>,sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read this dummy file:</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="st">"test.tsv"</span>,skip<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="st">"test.tsv"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="co">#&gt;   X.TimePoint X.Time X.a_lt_b</span></span>
<span><span class="co">#&gt; 1          T1   0.00     TRUE</span></span>
<span><span class="co">#&gt; 2          T2   0.01     TRUE</span></span>
<span><span class="co">#&gt; 3          T3   0.03    FALSE</span></span>
<span></span>
<span></span>
<span><span class="co"># check the type of the Booleans:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE  TRUE FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">test</span>,<span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; $X.TimePoint</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $X.Time</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $X.a_lt_b</span></span>
<span><span class="co">#&gt; [1] "logical"</span></span></code></pre></div>
<p>This setup makes sense, and will work out of the box because R’s
<code>read.delim</code> function infers the type of a column. It will
probably stop working if the values are inconsistent (some logical some
numeric).</p>
<p>However, if the model’s ODE content includes <code>TRUE</code> and
<code>FALSE</code> values in some way, e.g. as switches between several
distinct behaviours, then these Booleans should be written numerically
as <code>0</code> and <code>1</code>. Consider this:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make a similar dummy file, but this time it's an input</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"!!SBtab TableName='Input'"</span>,</span>
<span><span class="st">"!ID\t!Value\t!Comment"</span>,</span>
<span><span class="st">"B\tTRUE\ta Boolean value"</span>,</span>
<span><span class="st">"M\t65.3\ta numeric value"</span>,</span>
<span>file<span class="op">=</span><span class="st">"test.tsv"</span>,sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read the file:</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="st">"test.tsv"</span>,skip<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="st">"test.tsv"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span>
<span><span class="co">#&gt;   X.ID X.Value       X.Comment</span></span>
<span><span class="co">#&gt; 1    B    TRUE a Boolean value</span></span>
<span><span class="co">#&gt; 2    M    65.3 a numeric value</span></span>
<span></span>
<span><span class="co"># check the type of the Booleans:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "TRUE" "65.3"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">test</span>,<span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; $X.ID</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $X.Value</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $X.Comment</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span></span>
<span><span class="co"># similarly:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>,<span class="st">"1"</span>,<span class="st">"FALSE"</span>,<span class="st">"0"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: NAs introduced by coercion</span></span>
<span><span class="co">#&gt; [1] NA  1 NA  0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>,<span class="st">"1"</span>,<span class="st">"FALSE"</span>,<span class="st">"0"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE    NA FALSE    NA</span></span></code></pre></div>
<p>So, since we mixed types in one column, it didn’t work right.</p>
<p>To fix this use the integers <code>1</code> and <code>0</code>
explicitly.</p>
<p>However, even in the C code it can be made to work, even if you have
explicit TRUE/FALSE values in the actual reactions:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="kw">(</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">cat</span><span class="op">&lt;&lt;EOF</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="st">#!/usr/bin/tcc -run</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="st">#include &lt;stdlib.h&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="st">#include &lt;stdio.h&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="st">enum logical {FALSE, TRUE};</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="st">enum logical as_logical(int value){</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="st">    return !!value;</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="st">int main(int argc, char *argv[]){</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="st">    printf("TRUE=%i , FALSE=%i (both as integer), as_logical(2)=%i</span><span class="dt">\n</span><span class="st">",TRUE, FALSE, as_logical(2));</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="st">    return EXIT_SUCCESS;</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a><span class="kw">)</span> <span class="op">&gt;</span> a.c</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="fu">chmod</span> 744 a.c</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a><span class="ex">./a.c</span></span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="fu">rm</span> a.c</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a><span class="co">#&gt; TRUE=1 , FALSE=0 (both as integer), as_logical(2)=1</span></span></code></pre></div>
<p>But, this is unlikely to be very useful.</p>
<p>Inequality statements are allowed in the ODE itself (to simulate
switches in behavior).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
