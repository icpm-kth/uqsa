<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>shortMakeSharedLibrary • uqsa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="shortMakeSharedLibrary">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/install.html">Full Installation Instructions</a>
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensiticity Analysis</a>
    <h6 class="dropdown-header" data-toc-skip>Model and data management</h6>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing a model</a>
    <a class="dropdown-item" href="../articles/data.html">Importing data</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Paremeter estimation and uncertainty quantification</h6>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a model</a>
    <a class="dropdown-item" href="../articles/ABC_sampling.html">ABC sampling</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Sensitivity analysis</h6>
    <a class="dropdown-item" href="../articles/GSA.html">GSA following UQ</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/simAKAP79.html">Simulate AKAP79</a>
    <a class="dropdown-item" href="../articles/AKAP79.html">sample AKAP79</a>
    <a class="dropdown-item" href="../articles/AKAR4.html">sample AKAR4</a>
    <a class="dropdown-item" href="../articles/shortMakeSharedLibrary.html">Make a Shared Library</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="shortMakeSharedLibrary_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>shortMakeSharedLibrary</h1>
            
      
      
      <div class="d-none name"><code>shortMakeSharedLibrary.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span></code></pre></div>
<p>This is a short summary of how to make models for the simulator in the <a href="https://github.com/icpm-kth/rgsl" class="external-link">rgsl</a> package.</p>
<p><a href="https://github.com/icpm-kth/RPN-derivative" class="external-link">RPN-derivative</a> calculates derivatives or offloads that work on maxima or yacas, install them if you want to use the <code>--maxima</code> or <code>--yacas</code> options.</p>
<p><strong>Note</strong>: SBtab is <em>content</em> (tables), several <em>file-types</em> can store it.</p>
<p>If you are on MAC, please install the <a href="https://brew.sh/" class="external-link">homebrew</a> package manager to install essential software that everyone should have (a C compiler, pkg-config, etc.). We recommend that you do not use official apple software like xcode.</p>
<div class="section level2">
<h2 id="create-a-shared-library">Create a Shared Library<a class="anchor" aria-label="anchor" href="#create-a-shared-library"></a>
</h2>
<p>Here we assume that you wrote your own model in SBtab. For testing you can also download one of our example models. All code here is meant to be run in a terminal with a POSIX shell (bash, zsh, dash, ash) should all work (this is not usually pre-installed on windows).</p>
<p>Please be aware that some of the scripts use <code>awk</code> and <code>sed</code>, which may differ on different platforms (there is <em>one true awk</em>, GNU <code>gawk</code>, <code>mawk</code>, etc.). They differ in options they accept and regular expressions they understand.</p>
<p>We further assume that the format is a collection of tsv files.</p>
<p>The SBtabVFGEN package contains a file called <code>sbtab_to_vfgen</code> (it is a script, an RScript, R needed). Copy it into the directory of the model (or alias itm or symlink it, whatever you prefer)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ex">./sbtab_to_vfgen</span> *.tsv</span></code></pre></div>
<p>Afterwards, the directory should also contain a <code>.vf</code> file as well as an sbml <code>.xml</code> file and a zip file (with essentially the same content as the vf file). you should either download the contents of the <code>sh</code> directory in the <a href="https://github.com/icpm-kth/RPN-derivative" class="external-link">icpm-kth/RPN-derivative</a>, or clone the entire repository. You should <code>alias</code> the <code>ode.sh</code> script, so that you can call it from anywhere, or write out the path to it. Here we assume that it lies in your home directory.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="bu">alias</span> ode.sh=<span class="st">'~/RPN-derivative/sh/ode.sh'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="ex">ode.sh</span> -C --maxima myModel.vf <span class="op">&gt;</span> myModel_gvf.c</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="bu">[</span> <span class="ot">-f</span> myModel_gvf.c<span class="bu"> ]</span> <span class="kw">&amp;&amp;</span> <span class="fu">gcc</span> -shared -fPIC -O2 -o myModel.so myModel_gvf.c</span></code></pre></div>
<p>Now you have a <code>.c</code> source file and a shared library <code>.so</code> file.</p>
</div>
<div class="section level2">
<h2 id="sbtab-as-xlsx">SBtab as XLSX<a class="anchor" aria-label="anchor" href="#sbtab-as-xlsx"></a>
</h2>
<p>Here the same procedure applies, but we alias <code>sbtab_to_vfgen</code> rather than copying it this time. Also, this time we use yacas to calculate the derivatives, rather than maxima. We create both C code and R code this time.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="bu">alias</span> sbtab_to_vfgen=<span class="st">'~/SBtabVFGEN/sbtab_to_vfgen'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="bu">alias</span> ode.sh=<span class="st">'~/RPN-derivative/sh/ode.sh'</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="ex">./sbtab_to_vfgen</span> myModel.xlsx</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="ex">ode.sh</span> -C --yacas myModel.vf <span class="op">&gt;</span> myModel_gvf.c</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="ex">ode.sh</span> -R --yacas myModel.vf <span class="op">&gt;</span> myModel.R</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="bu">[</span> <span class="ot">-f</span> myModel_gvf.c<span class="bu"> ]</span> <span class="kw">&amp;&amp;</span> <span class="fu">gcc</span> -shared -fPIC -O2 -o myModel.so myModel_gvf.c</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sbtab-as-ods">SBtab as ODS<a class="anchor" aria-label="anchor" href="#sbtab-as-ods"></a>
</h2>
<p>We repeat the same procedure as with XLSX, but the model name is a variable, and the C compiler is whatever target <code>cc</code> links to:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="va">modelName=</span><span class="st">'myModel'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="bu">alias</span> sbtab_to_vfgen=<span class="st">'~/SBtabVFGEN/sbtab_to_vfgen'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="bu">alias</span> ode.sh=<span class="st">'~/RPN-derivative/sh/ode.sh'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="ex">./sbtab_to_vfgen</span> <span class="va">${modelName}</span>.ods</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="ex">ode.sh</span> -C --yacas <span class="va">${modelName}</span>.vf <span class="op">&gt;</span> <span class="va">${modelName}</span>_gvf.c</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="ex">ode.sh</span> -R --yacas <span class="va">${modelName}</span>.vf <span class="op">&gt;</span> <span class="va">${modelName}</span>.R</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="bu">[</span> <span class="ot">-f</span> <span class="va">${modelName}</span>_gvf.c<span class="bu"> ]</span> <span class="kw">&amp;&amp;</span> <span class="fu">cc</span> -shared -fPIC -O2 -o <span class="va">${modelName}</span>.so <span class="va">${modelName}</span>_gvf.c</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h2>
<p>Now you should have C sources and a shared library, or error messages about the SBtab content (if the files contain errors).</p>
<p>The simulator can use the shared library directly. But take into account that <code>${modelName}.so</code> is machine specific and will not work if you copy it onto a completely different kind of machine (it may work if the two are similar enough).</p>
<p>Please take time to open and inspect the C sources and try to spot obvious mistakes.</p>
</div>
<div class="section level2">
<h2 id="rpn-derivative">RPN-derivative<a class="anchor" aria-label="anchor" href="#rpn-derivative"></a>
</h2>
<p>The RPN-derivative package can also work without maxima or yacas, but needs to be compiled for this to work. Do this in the RPN-derivative’s root directory:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="fu">make</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="fu">make</span> test</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="fu">sudo</span> make install</span></code></pre></div>
<p>If you get error messages about <code>pkg-config</code> not being found, install it (you are probably on MAC: <code>brew install pkg-config</code>). If you get error messages about missing directories, make them (<code>mkdir /path/to/missing/directory</code>).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
