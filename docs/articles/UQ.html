<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>Bayesian Uncertainty Quantification • uqsa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Uncertainty Quantification">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/installExplanations.html">Explanation for System Prerequisites</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing Models</a>
    <a class="dropdown-item" href="../articles/data.html">Importing Data</a>
    <a class="dropdown-item" href="../articles/events.html">Transformation Events</a>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <a class="dropdown-item" href="../articles/generateCodeInR.html">Generate Model Code</a>
    <a class="dropdown-item" href="../articles/intermediateFiles.html">Advantages of Intermediates</a>
    <a class="dropdown-item" href="../articles/ODE-Model.html">ODE Model</a>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a Model</a>
    <a class="dropdown-item" href="../articles/GSA.html">Global Sensitivity Analysis</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAR4</h6>
    <a class="dropdown-item" href="../articles/simAKAR4.html">Simulate deterministic AKAR4</a>
    <a class="dropdown-item" href="../articles/simAKAR4stochastic.html">Simulate stochastic AKAR4</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4.html">UQ on deterministic AKAR4</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4mpi.html">UQ on deterministic AKAR4 with MPI</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4stochastic.html">UQ on stochasic AKAR4</a>
    <a class="dropdown-item" href="../articles/GSA_AKAR4.html">GSA on AKAR4</a>
    <a class="dropdown-item" href="../articles/UQSA_AKAR4.html">UQ and SA on AKAR4</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAP79</h6>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CaMKII</h6>
    <a class="dropdown-item" href="../articles/smmala.html">Calibrate CaMKII with SMMALA</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extra</h6>
    <a class="dropdown-item" href="../articles/extraExamples.html">More examples...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bayesian Uncertainty Quantification</h1>
            
      
      
      <div class="d-none name"><code>UQ.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span></code></pre></div>
<p>Baysian uncertainty quantification aims to establish the amount of
knowledge we have (or indeed lack) about the possible values of model
parameters. Sometimes this is described as our belief in different
parameter values. The knowledge or belief is expressed in the form of a
probability distribution<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Even though the parameters, as such, are not &lt;em&gt;random
variables&lt;/em&gt;. In this case the probability is related to the
randomness within the observed of data: the measurement noise. The noise
has direct implications for the possible parameters: parameters with
high probability density values can easily explain the data, while
unlikely parameters require the random noise to have had
uncharacteristically large values for the given measurements&lt;/p&gt;"><sup>1</sup></a> over the parameters: the <em>posterior
distribution</em> in the Bayesian setting. The posterior distribution is
obtained by updating prior information we have on the parameters
(described by the <em>prior distribution</em>), using information from
the observed data and the model structure (specified through the
<em>likelihood function</em>). The posterior distribution can be
calculated with Bayes formula as:</p>
<p><span class="math inline">\(p(\theta|D) = \frac{ p(D|\theta)p(\theta)
}{p(D)}\)</span></p>
<p>where <span class="math inline">\(p(\theta|D)\)</span> denotes the
posterior density of the parameter <span class="math inline">\(\theta\)</span> given the observed data <span class="math inline">\(D\)</span>, <span class="math inline">\(p(D|\theta)\)</span> is the likelihood function,
<span class="math inline">\(p(\theta)\)</span> the prior density, and
<span class="math inline">\(p(D)\)</span> the evidence, a normalizing
constant that are not needed during the sampling we perform here.</p>
<p>To sample from the posterior distribution we rely on <em>Markov Chain
Monte Carlo</em> (MCMC) methods. These only require the numerator in the
previous equation (i.e., prior and likelihood) as <span class="math inline">\(p(D)\)</span> cancels out in the calculations. We
have implemented different types of MCMC methods within UQSA, adequate
for different situations.</p>
<p>Standard MCMC methods require the likelihood function can be
formulated explicitly (<em>likelihood-based</em> methods).This is,
however, not always the case and then one has to work with
<em>likelihood-free</em> methods, like <em>Approximate Bayesian
Computation (ABC)</em>. In UQSA we have implemented both
likelihood-based and likelihood-free methods.</p>
<p>Biochemical reaction network models can be formulated either as
deterministic (ODE) or stochastic systems. For the deterministic
formulation we can easily formulate the likelihood function (e.g. by
assuming Gaussian noise), for the stochastic formulation this is more
difficult and we need to use ABC.</p>
<div class="section level2">
<h2 id="likelihood-based">Likelihood-based<a class="anchor" aria-label="anchor" href="#likelihood-based"></a>
</h2>
<p>When the likelihood is available, we recommend the use of
likelihood-based MCMC algorithms, such as SMMALA and Random Walk
Metropolis (RWM). These requires three main steps as described below.
The details are described in the <a href="sampleAKAR4.html">AKAR4</a>
(RWM), AKAP79 and <a href="smmala.html">CaMKII</a> (SMMALA)
examples.</p>
<p><strong>1. Define a prior distribution</strong> In UQSA, we have
implemented functions to easily create a probability density function
(<code><a href="../reference/dCopulaPrior.html">dCopulaPrior()</a></code>, <code><a href="../reference/dNormalPrior.html">dNormalPrior()</a></code>,
<code><a href="../reference/dUniformPrior.html">dUniformPrior()</a></code>; “d” stands for density) and functions that
provide samples from such distributions (<code><a href="../reference/rCopulaPrior.html">rCopulaPrior()</a></code>,
<code><a href="../reference/rNormalPrior.html">rNormalPrior()</a></code>, <code><a href="../reference/rUniformPrior.html">rUniformPrior()</a></code>; “r” stands
for random). The user can also define new R functions with customized
prior density functions and corresponding functions to sample from these
distributions.</p>
<p><strong>2. Define a likelihood function</strong> To use
likelihood-based MCMC methods, the likelihood function must be
specified. In UQSA, this can be done using function
<code>loglikelihoodFunc()</code>. Within the loglikelihood function (for
these ODE models) simulated data points are compared to experimental
data points taking an error model into account (usually, a normally
distributed measurement error is assumed).</p>
<p><strong>3. Run MCMC</strong> The likelihood-based MCMC methods
available in UQSA are the <em>Random Walk Metropolis</em> (RWM)
algorithm and <em>SMMALA</em>.</p>
<ul>
<li><p><strong>RWM</strong> can be used to sample from essentially any
posterior distribution (when the likelihood function is available). This
MCMC algorithm is based on proposing a parameter for the next state of
the chain by sampling from a multivariate normal distribution; the
proposal is then accepted or rejected according to the
Metropolis-Hasting acceptance probability.</p></li>
<li><p><strong>SMMALA</strong> is a more efficient MCMC method, but at a
cost: the gradient of the posterior distribution is required.</p></li>
</ul>
<p>There are three main functions that are used to set up and run the
MCMC simulation. <code><a href="../reference/mcmcInit.html">mcmcInit()</a></code>, <code><a href="../reference/mcmcUpdate.html">mcmcUpdate()</a></code>, and
<code><a href="../reference/mcmc.html">mcmc()</a></code>.</p>
<div class="section level3">
<h3 id="parallel-tempering">Parallel tempering<a class="anchor" aria-label="anchor" href="#parallel-tempering"></a>
</h3>
<p>The likelihood-based methods can also be run in a <a href="https://en.wikipedia.org/wiki/Parallel_tempering" class="external-link">parallel
tempering</a> setting, where several MCMC chains are started at the same
time, but at different temperatures (levels of relaxation). More details
can be found in the <a href="mpi.html">Multiple chains via MPI</a>
example.</p>
</div>
</div>
<div class="section level2">
<h2 id="likelihood-free-abc">Likelihood-free (ABC)<a class="anchor" aria-label="anchor" href="#likelihood-free-abc"></a>
</h2>
<p>If it is not possible to write an explicit function for the
likelihood we can use the ABC approach. Here we also simulate data from
the (stochastic) model (for a given parameter vector) and compare this
to the experimental data. If the simulated data are “close” (based on
some distance measure) to the experimental data (observations), then we
consider it “likely” that the observed data have been generated by the
model with the given parameters. Otherwise, if the simulated data are
“far” from the observations, we consider this “unlikely”, and discard
the parameter vector (it will not be part of the posterior sample). We
use a sharp threshold to decide if the parameters should be accepted or
not.</p>
<p>There are three major steps when running ABC:</p>
<p><strong>1. Define a prior distribution</strong> This is done in the
same way as for the likelihood based approch described above.</p>
<p><strong>2. Define an objective function</strong> Objective functions
for ABC can be defined with <code><a href="../reference/makeObjective.html">makeObjective()</a></code> and
<code><a href="../reference/makeObjectiveSSA.html">makeObjectiveSSA()</a></code>. The former is used with deterministic
models<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;We sometimes use ABC on deterministic models, because it
is a robust method. In these cases we add noise to the simulations, as
ABC is designed for stochastic models. See this &lt;a href="simAKAP79.html"&gt;AKAP79&lt;/a&gt; example.&lt;/p&gt;'><sup>2</sup></a>,
and the latter with stochastic models, where the “Stochastic Simulation
Algorithm” is used to simulate from the model (hence, “SSA” in the
function name). The objective function: 1. Take a parameter vector as
input, 2. Simulate data from the model given this parameter and 3.
Return the distance between simulated and observed data.</p>
<p><strong>3. Run MCMC</strong> The likelihood-free algorithm that we
implemented in UQSA is ABC-MCMC. At each iteration of ABC-MCMC, a
parameter is proposed by sampling from a multivariate normal
distribution (as in RWM). However, the Metropolis-Hastings acceptance
probability cannot be computed, because it depends on the likelihood
function. Instead, the simulation approach described before is used
(data are simulated and compared with observed data).</p>
<p>This algorithm can be run in UQSA using function
<code><a href="../reference/ABCMCMC.html">ABCMCMC()</a></code>.</p>
<div class="section level3">
<h3 id="precalibration">PreCalibration<a class="anchor" aria-label="anchor" href="#precalibration"></a>
</h3>
<p>Before running the MCMC algorithms with the ABC approach, it is
useful to run a precalibration to determine good starting values for the
MCMC chains, and obtain further information, such as a crude estimate of
the parameter covariances. Precalibration can be performed in UQSA using
function <code><a href="../reference/preCalibration.html">preCalibration()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="mapping-between-model-parameters-and-mcmc-parameters">Mapping between model parameters and MCMC parameters<a class="anchor" aria-label="anchor" href="#mapping-between-model-parameters-and-mcmc-parameters"></a>
</h2>
<p>The parameters <span class="math inline">\(\theta\)</span> on which
we perform UQ may be a function of some physical parameter <span class="math inline">\(\rho\)</span>, for example, <span class="math inline">\(\theta = \log(\rho)\)</span>. We therefore need a
function that maps Markov chain parameters <span class="math inline">\(\theta\)</span> into the model parameters <span class="math inline">\(\rho\)</span>. We usually call this function
“parMap”. This function is required in the input list of some UQSA
functions.</p>
<p>For biochemical reaction network models, the internal parameters
<span class="math inline">\(\rho\)</span> are typically quantities like
reaction rate coefficients <span class="math inline">\(k_{\{f,b\}}\)</span>, dissociation constants
(equilibrium constants) <span class="math inline">\(K_{D}\)</span>, Hill
exponents <span class="math inline">\(m\)</span>, and other parameters
that relate to gene expression, enzyme-substrate interaction, or other
biochemical processes.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
