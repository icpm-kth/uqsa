<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>Importing Data • uqsa</title>
<script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Importing Data">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/installExplanations.html">Explanation for System Prerequisites</a>
    <a class="dropdown-item" href="../articles/path.html">The PATH variable</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/uq.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Model and data management</h6>
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing Models</a>
    <a class="dropdown-item" href="../articles/data.html">Importing Data</a>
    <a class="dropdown-item" href="../articles/events.html">Transformation Events</a>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <a class="dropdown-item" href="../articles/GenerateCodeInSHELL.html">Generate C Code Outside of R</a>
    <a class="dropdown-item" href="../articles/intermediateFiles.html">Advantages of Intermediates</a>
    <a class="dropdown-item" href="../articles/ODE-Model.html">ODE Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Paremeter estimation and uncertainty quantification</h6>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a Model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Sensitivity Analysis</h6>
    <a class="dropdown-item" href="../articles/GSA.html">Global Sensitivity Analysis</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/simAKAP79.html">Simulate AKAP79</a>
    <a class="dropdown-item" href="../articles/AKAP79.html">Sample AKAP79</a>
    <a class="dropdown-item" href="../articles/AKAR4.html">Sample AKAR4</a>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Importing Data</h1>
            
      
      
      <div class="d-none name"><code>data.Rmd</code></div>
    </div>

    
    
<p>The data is part of the SBtab document, but it can also be seen as
separate from the model, so it’s imported with a different function.
This function also loads the inputs and initial values for the model.
When determining the inputs, the function takes conservation laws into
account and calculates input values for conserved quantities, based on
the stated initial values. The imported object <code>ex</code> is a list
of simulation instructions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SBtabVFGEN</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">'AKAR4cl'</span><span class="op">)</span>                         <span class="co"># file names</span></span>
<span><span class="va">sb</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>                  <span class="co"># a list of data.frames</span></span>
<span><span class="co">#&gt; [tsv] file[1] «100nM.tsv» belongs to Document «AKAR4cl»</span></span>
<span><span class="co">#&gt;  I'll take this as the Model Name.</span></span>
<span><span class="co">#&gt; 100nM.tsv  25nM.tsv  400nM.tsv  Compound.tsv  Experiments.tsv  Output.tsv  Parameter.tsv  Reaction.tsv</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">'AKAR4cl'</span>,f<span class="op">=</span><span class="st">"RDS"</span><span class="op">)</span><span class="op">)</span>       <span class="co"># previously saved laws</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab.data.html" class="external-link">sbtab.data</a></span><span class="op">(</span><span class="va">sb</span>,<span class="va">cl</span><span class="op">)</span>                  <span class="co"># includes the data</span></span>
<span><span class="va">ex</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">input</span></span>
<span><span class="co">#&gt; AKAR4_C_ConservedConst   AKAR4_ConservedConst </span></span>
<span><span class="co">#&gt;                    0.4                   -0.2</span></span>
<span><span class="va">ex</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">initialState</span></span>
<span><span class="co">#&gt; AKAR4p      C </span></span>
<span><span class="co">#&gt;    0.0    0.4</span></span></code></pre></div>
<p>The data-sets themselves can be stored in a normal SBtab table, using
any valid <code>TableName</code>. How many data sets there are and their
type are listed in the <em>table of experiments</em>:
<code>Experiments.tsv</code>. Data not listed in the table of
experiments is not loaded with the <code>sbtab.data</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sb</span><span class="op">$</span><span class="va">Experiments</span></span>
<span><span class="co">#&gt;                   !Name    &gt;C</span></span>
<span><span class="co">#&gt; AKAR4_400nM AKAR4_400nM 0.400</span></span>
<span><span class="co">#&gt; AKAR4_100nM AKAR4_100nM 0.100</span></span>
<span><span class="co">#&gt; AKAR4_25nM   AKAR4_25nM 0.025</span></span>
<span><span class="co">#&gt;                                                                                     !Comment</span></span>
<span><span class="co">#&gt; AKAR4_400nM  Figure 3—figure supplement 1 in https://doi.org/10.7554/eLife.68164 (dark blue)</span></span>
<span><span class="co">#&gt; AKAR4_100nM       Figure 3—figure supplement 1 in https://doi.org/10.7554/eLife.68164 (gray)</span></span>
<span><span class="co">#&gt; AKAR4_25nM  Figure 3—figure supplement 1 in https://doi.org/10.7554/eLife.68164 (light blue)</span></span>
<span><span class="co"># The first one has this data-set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex</span><span class="op">$</span><span class="va">AKAR4_400nM</span><span class="op">$</span><span class="va">outputValues</span><span class="op">)</span></span>
<span><span class="co">#&gt;          AKAR4pOUT</span></span>
<span><span class="co">#&gt; E400T001    108.60</span></span>
<span><span class="co">#&gt; E400T002    111.35</span></span>
<span><span class="co">#&gt; E400T003    108.75</span></span>
<span><span class="co">#&gt; E400T004    111.40</span></span>
<span><span class="co">#&gt; E400T005    111.70</span></span>
<span><span class="co">#&gt; E400T006    113.25</span></span></code></pre></div>
<p>The values in <code>ex</code> are simulation instructions for all
experiments.</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="15%">
<col width="71%">
</colgroup>
<thead><tr class="header">
<th align="right">item</th>
<th align="center">type</th>
<th align="left">meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">input</td>
<td align="center">numeric vector</td>
<td align="left">known input parameters</td>
</tr>
<tr class="even">
<td align="right">initialTime</td>
<td align="center">numeric vector</td>
<td align="left">a scalar time <span class="math inline">\(t_0\)</span>
</td>
</tr>
<tr class="odd">
<td align="right">initialState</td>
<td align="center">numeric vector</td>
<td align="left">initial state <span class="math inline">\(x_0\)</span>
of the ode <span class="math inline">\(\dot x =
f(x(t),t,p=c(k,u))\)</span>, <span class="math inline">\(x(t_0)=x_0\)</span>
</td>
</tr>
<tr class="even">
<td align="right">outputTimes</td>
<td align="center">numeric vector</td>
<td align="left">a time vector that corresponds to when measurements
were taken</td>
</tr>
<tr class="odd">
<td align="right"></td>
<td align="center"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="right">outputValues</td>
<td align="center">data.frame</td>
<td align="left">the values of the data at the above outputTimes</td>
</tr>
<tr class="odd">
<td align="right">errorValues</td>
<td align="center">data.frame</td>
<td align="left">an indication of the measurement error/noise (standard
error)</td>
</tr>
<tr class="even">
<td align="right">events</td>
<td align="center">list</td>
<td align="left">a sudden transformation event</td>
</tr>
</tbody>
</table>
<p>But, any data sets not present in Experiments, are still
accessible:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sb</span><span class="op">$</span><span class="va">AKAR4_400nM</span><span class="op">)</span></span>
<span><span class="co">#&gt;          !Time &gt;AKAR4pOUT ~AKAR4pOUT</span></span>
<span><span class="co">#&gt; E400T001   -15     108.60    14.7950</span></span>
<span><span class="co">#&gt; E400T002   -10     111.35    14.9325</span></span>
<span><span class="co">#&gt; E400T003    -5     108.75    14.8025</span></span>
<span><span class="co">#&gt; E400T004     0     111.40    14.9350</span></span>
<span><span class="co">#&gt; E400T005     5     111.70    14.9500</span></span>
<span><span class="co">#&gt; E400T006    10     113.25    15.0275</span></span></code></pre></div>
<p>This works for any data set that has a TSV file - or a sheet in any
other valid format (ods, xlsx). This table is just not a simulation
instruction:</p>
<ul>
<li>
<code>sb</code> has the values of all tsv files/sheets</li>
<li>
<code>ex</code> has data and simulation instructions for the rgsl
package</li>
</ul>
<p>Each experiment is a time series experiment, after the import (dose
response sets are converted to one time series experiment per
point).</p>
<p>More about this topic can be found in the <a href="SBtab.html">SBtab</a> section.</p>
<p>The rest of this page explains SBtab features that are related to
data-sets and experiment descriptions.</p>
<hr>
<div class="section level3">
<h3 id="time-series">Time Series<a class="anchor" aria-label="anchor" href="#time-series"></a>
</h3>
<p>In a time series table, the first column is called
<code>!TimePoint</code>, the second is typically <code>!Time</code>,
followed by the measured quantities labelled as
<code>&gt;outputFunctionID</code> (values) and
<code>~outputFunctionID</code> (error estimates).</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="17%">
<col width="65%">
</colgroup>
<thead><tr class="header">
<th align="right">Label</th>
<th align="center">Example</th>
<th align="left">Meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">!TimePoint</td>
<td align="center"><code>Experiment0Time0</code></td>
<td align="left">same as !ID, but for times (a unique string)</td>
</tr>
<tr class="even">
<td align="right">!Time</td>
<td align="center"><code>-0.5</code></td>
<td align="left">a floating point constant</td>
</tr>
<tr class="odd">
<td align="right">&gt;outputFunctionID</td>
<td align="center"><code>&gt;Calcium_Out</code></td>
<td align="left">values that are meant to be compared to the Output
called <code>Calcium_Out</code>
</td>
</tr>
<tr class="even">
<td align="right">~outputFunctionID</td>
<td align="center"><code>~Calcium_Out</code></td>
<td align="left">error estimated for the values in
<em>&gt;outputFunctionID</em>
</td>
</tr>
</tbody>
</table>
<p>Each time series typically requires one model simulation to reproduce
(unless scheduled events are happening).</p>
<div class="section level4">
<h4 id="example-time-series">Example Time Series<a class="anchor" aria-label="anchor" href="#example-time-series"></a>
</h4>
<pre><code>!!SBtab Document='myModel' TableName='DataSetBeta'
 !TimePoint  !Time    &gt;A_out  ~A_out      &gt;totalB  ~totalB 
       E0T0   -1.0      1.20  0.012         201.1  12
       E0T1   +0.0      11.8  0.12          203.2  11
       E0T2   +1.0      31.7  0.19          198.7  13</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="dose-response">Dose Response<a class="anchor" aria-label="anchor" href="#dose-response"></a>
</h3>
<p>An experiment that maps an increasing input to output values. In such
cases the output has to happen at one pre-defined time-point for each
dose. These dose-response curves will be transformed into <em>n</em>
time-series experiments during parsing, where <em>n</em> is the number
of content-rows (without headers).</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="17%">
<col width="65%">
</colgroup>
<thead><tr class="header">
<th align="right">label</th>
<th align="center">example</th>
<th align="left">meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">!ID</td>
<td align="center"><code>Experiment0Dose0</code></td>
<td align="left">a unique string, identifying this dose</td>
</tr>
<tr class="even">
<td align="right">&gt;anInput</td>
<td align="center"><code>300</code></td>
<td align="left">a valid value for one of the input parameters</td>
</tr>
<tr class="odd">
<td align="right">&gt;outputFunctionID</td>
<td align="center"><code>&gt;Calcium_Out</code></td>
<td align="left">values that are meant to be compared to the Output
called <code>Calcium_Out</code>
</td>
</tr>
<tr class="even">
<td align="right"></td>
<td align="center"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="right">~outputFunctionID</td>
<td align="center"><code>~Calcium_Out</code></td>
<td align="left">error estimated for the values in
<em>&gt;outputFunctionID</em>
</td>
</tr>
</tbody>
</table>
<p>A dose response curve requires <em>n</em> simulations of the model to
reproduce.</p>
<div class="section level4">
<h4 id="example-dose-response-curve">Example Dose Response Curve<a class="anchor" aria-label="anchor" href="#example-dose-response-curve"></a>
</h4>
<p>This curve has two inputs and one output (<code>A_final</code>), each
line is a separate time series with one (final) <em>measurement time
point</em>.</p>
<pre><code>!!SBtab Document='myModel' TableName='DataSetGamma'
  !ID  &gt;treatment_dose  &gt;treatment_duration  &gt;A_final  ~A_final 
 E0D0  200                50                     50.1  1.2
 E0D1  1000               50                     83.2  0.9
 E0D2  7000               25                     74.7  1.8</code></pre>
<p>Anything more complex has to be expressed as a
<code>Time series</code> with an event schedule. The measurement time is
taken from the <code>Experiments</code> table (Experiments.tsv).</p>
</div>
</div>
<div class="section level2">
<h2 id="scheduled-events">Scheduled Events<a class="anchor" aria-label="anchor" href="#scheduled-events"></a>
</h2>
<p>An experiment can contain sudden events, in <em>systems biology</em>
this is useful to describe experiments that include an intervention at a
specified time (activation, silencing, stimulus, action potential,
etc.). These events happen much faster than the system dynamics and
modelling them exactly would slow down the solver dramatically. In the
case of an event at time <span class="math inline">\(t\)</span>, the
solver is stopped, a transformation to the current state <span class="math inline">\(x(t)\)</span> and parameters <span class="math inline">\(p\)</span> is applied (in our C code, in the
<code>rgsl</code> package, not with <code>deSolve</code>):</p>
<p>The SBtab table <code>Transformation</code>
(<code>Tranformation.tsv</code> as a file) defines which transformations
the system is subject to.</p>
<p>An event table defines for each experiment, when the transformations
apply.</p>
<p>The transformation function (C code), is auto-generated by <a href="icpm-kth/RPN-derivative">RPN-derivative/sh/ode.sh</a>.</p>
<p>An example of a Transformation table from the <em>Spike</em>
model:</p>
<pre><code>!!SBtab Document='Spike' TableName='Transformation'                 
!ID   &gt;Ca  &gt;Buffer
APCa  Ca   A*(k2-k1)*dose</code></pre>
<p>These transformations apply at times given in an event schedule (Dose
not used):</p>
<pre><code>!!SBtab Document='Spike' TableName='AP20Hz'     
!ID          !Time  !Transformation  !Dose
Freq20HzAP0  0      APCa             1.0
Freq20HzAP1  50     APCa             1.0
Freq20HzAP2  100    APCa             1.0
Freq20HzAP3  150    APCa             1.0
Freq20HzAP4  200    APCa             1.0
Freq20HzAP5  250    APCa             1.0
Freq20HzAP6  300    APCa             1.0
Freq20HzAP7  350    APCa             1.0
Freq20HzAP8  400    APCa             1.0</code></pre>
<p>And this schedule is applied to an experiment by listing it in the
Experiment table:</p>
<pre><code>!!SBtab Document='Spike' TableName='Experiment'             
!ID    !Event  !T0
E20Hz  AP20Hz  -5</code></pre>
<p>The <code>!Event</code> column specifies the event schedule for this
experiment (each experiment is one row).</p>
<p>This setup will create this C function:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="dt">int</span> Spike_event<span class="op">(</span><span class="dt">double</span> t<span class="op">,</span> <span class="dt">double</span> y_<span class="op">[],</span> <span class="dt">void</span> <span class="op">*</span>par<span class="op">,</span> <span class="dt">int</span> EventLabel<span class="op">,</span> <span class="dt">double</span> dose<span class="op">)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="dt">double</span> <span class="op">*</span>p_<span class="op">=</span>par<span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>y_ <span class="op">||</span> <span class="op">!</span>par <span class="op">||</span> EventLabel<span class="op">&lt;</span><span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="kw">enum</span> eventLabel <span class="op">{</span> APCa<span class="op">,</span> numEvents <span class="op">};</span> <span class="co">/* event name indexes */</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="kw">enum</span> stateVariable <span class="op">{</span> var_Ca<span class="op">,</span>var_Buffer<span class="op">,</span> numStateVar <span class="op">};</span> <span class="co">/* state variable indexes  */</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="kw">enum</span> param <span class="op">{</span> par_k1<span class="op">,</span>par_k2<span class="op">,</span>par_A<span class="op">,</span>par_CaBase<span class="op">,</span> numParam <span class="op">};</span> <span class="co">/* parameter indexes  */</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="dt">double</span> k1<span class="op">=</span>p_<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    <span class="dt">double</span> k2<span class="op">=</span>p_<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="dt">double</span> A<span class="op">=</span>p_<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="dt">double</span> CaBase<span class="op">=</span>p_<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="dt">double</span> Ca<span class="op">=</span>y_<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>    <span class="dt">double</span> Buffer<span class="op">=</span>y_<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>    <span class="dt">double</span> rf1<span class="op">=</span>Buffer<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>    <span class="dt">double</span> rf2<span class="op">=-</span>k1<span class="op">*</span>k2<span class="op">*</span>Ca<span class="op">-(</span>k1<span class="op">+</span>k2<span class="op">)*</span>Buffer<span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>    <span class="cf">switch</span><span class="op">(</span>EventLabel<span class="op">){</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>    <span class="cf">case</span> APCa<span class="op">:</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>        y_<span class="op">[</span>var_Buffer<span class="op">]</span> <span class="op">=</span> A<span class="op">*(</span>k2<span class="op">-</span>k1<span class="op">)*</span>dose<span class="op">;</span> <span class="co">/* state variable transformation */</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>    <span class="cf">return</span> GSL_SUCCESS<span class="op">;</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Any number of transformations can be added to the table. The
<code>switch</code> statement will select the correct one to perform,
based on the label (integer/enum). In this case, there is only one
transformation. See <a href="events.html">Transformation Events</a> for
more information.</p>
</div>
<div class="section level2">
<h2 id="gaussian-measurement-errors">Gaussian Measurement errors<a class="anchor" aria-label="anchor" href="#gaussian-measurement-errors"></a>
</h2>
<p>For Gaussian noise, <code>~xyz</code> values can be the standard
deviation of the mean (standard error). the data frame has the same
shape and names as the output values. The usual way to write this
somewhere is typically</p>
<pre><code>outputValues ± errorValues</code></pre>
<p>For other error models, or noise distributions, the user can decide
what kind of values are useful and use them in their custom scoring
functions (untested by us).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
