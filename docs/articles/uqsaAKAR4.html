<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uqsa">
<title>Uncertainty Quantification on AKAR4 (deterministic) • uqsa</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Uncertainty Quantification on AKAR4 (deterministic)">
<meta property="og:description" content="uqsa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uqsa</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uqsa.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-installation">Installation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-installation">
    <a class="dropdown-item" href="../articles/installation.html">Short Instructions</a>
    <a class="dropdown-item" href="../articles/installExplanations.html">Explanation for System Prerequisites</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-documentation">Documentation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-documentation">
    <a class="dropdown-item" href="../articles/SBtab.html">SBtab</a>
    <a class="dropdown-item" href="../articles/models.html">Importing Models</a>
    <a class="dropdown-item" href="../articles/data.html">Importing Data</a>
    <a class="dropdown-item" href="../articles/events.html">Transformation Events</a>
    <a class="dropdown-item" href="../articles/user_model.html">Build your own Model</a>
    <a class="dropdown-item" href="../articles/generateCodeInR.html">Generate Model Code</a>
    <a class="dropdown-item" href="../articles/intermediateFiles.html">Advantages of Intermediates</a>
    <a class="dropdown-item" href="../articles/ODE-Model.html">ODE Model</a>
    <a class="dropdown-item" href="../articles/simulate.html">Simulating a Model</a>
    <a class="dropdown-item" href="../articles/mpi.html">Multiple chains via MPI</a>
    <a class="dropdown-item" href="../articles/GSA.html">Global Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/UQ.html">Uncertainty Quantification</a>
    <a class="dropdown-item" href="../articles/sa.html">Sensitivity Analysis</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-examples">Examples</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-examples">
    <a class="dropdown-item" href="../articles/examples_overview.html">Overview</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAR4</h6>
    <a class="dropdown-item" href="../articles/simAKAR4.html">Simulate deterministic AKAR4</a>
    <a class="dropdown-item" href="../articles/simAKAR4stochastic.html">Simulate stochastic AKAR4</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4.html">UQ on deterministic AKAR4</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4mpi.html">UQ on deterministic AKAR4 with MPI</a>
    <a class="dropdown-item" href="../articles/sampleAKAR4stochastic.html">UQ on stochasic AKAR4</a>
    <a class="dropdown-item" href="../articles/GSA_AKAR4.html">GSA on AKAR4</a>
    <a class="dropdown-item" href="../articles/uqsaAKAR4.html">UQ and SA on AKAR4</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>AKAP79</h6>
    <a class="dropdown-item" href="../articles/sampleAKAP79.html">UQ on deterministic AKAP79</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>CaMKII</h6>
    <a class="dropdown-item" href="../articles/smmala.html">Calibrate CaMKII with SMMALA</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extra</h6>
    <a class="dropdown-item" href="../articles/extraExamples.html">More examples...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Uncertainty Quantification on AKAR4 (deterministic)</h1>
            
      
      
      <div class="d-none name"><code>uqsaAKAR4.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://icpm-kth.github.io/uqsa/">uqsa</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SBtabVFGEN</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rgsl</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-model-and-data">Load Model and Data<a class="anchor" aria-label="anchor" href="#load-model-and-data"></a>
</h2>
<p>First we load the model and data, for detailed explinations see
previous examples.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span>  <span class="op">&lt;-</span> <span class="fu">uqsa</span><span class="fu">::</span><span class="fu"><a href="../reference/uqsa_example.html">uqsa_example</a></span><span class="op">(</span><span class="st">"AKAR4"</span><span class="op">)</span></span>
<span><span class="va">sb</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_from_tsv.html" class="external-link">sbtab_from_tsv</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">#&gt; [tsv] file[1] «AKAR4_100nM.tsv» belongs to Document «AKAR4»</span></span>
<span><span class="co">#&gt;  I'll take this as the Model Name.</span></span>
<span><span class="co">#&gt; AKAR4_100nM.tsv  AKAR4_25nM.tsv  AKAR4_400nM.tsv  AKAR4_Compound.tsv  AKAR4_Experiments.tsv  AKAR4_Output.tsv  AKAR4_Parameter.tsv  AKAR4_Reaction.tsv</span></span>
<span><span class="va">m</span>  <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab_to_vfgen.html" class="external-link">sbtab_to_vfgen</a></span><span class="op">(</span><span class="va">sb</span>, cla<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Document Name: AKAR4.</span></span>
<span><span class="co">#&gt; SBtab has 8 tables.</span></span>
<span><span class="co">#&gt; The names of SBtab[[1]]:</span></span>
<span><span class="co">#&gt; !Time, &gt;AKAR4pOUT, ~AKAR4pOUT</span></span>
<span><span class="co">#&gt;                 !Name                             !KineticLaw</span></span>
<span><span class="co">#&gt; reaction_1 reaction_1 kf_C_AKAR4*C*AKAR4 - kb_C_AKAR4*AKAR4_C</span></span>
<span><span class="co">#&gt; reaction_2 reaction_2                      kcat_AKARp*AKAR4_C</span></span>
<span><span class="co">#&gt;                  !ReactionFormula !IsReversible</span></span>
<span><span class="co">#&gt; reaction_1  C + AKAR4 &lt;=&gt; AKAR4_C             1</span></span>
<span><span class="co">#&gt; reaction_2 AKAR4_C &lt;=&gt; AKAR4p + C             0</span></span>
<span><span class="co">#&gt; There is no «Constant» Table in this model. This is OK.</span></span>
<span><span class="co">#&gt; There is no «Expression» Table in this model. This is OK.</span></span>
<span><span class="co">#&gt; compound names:</span></span>
<span><span class="co">#&gt; [1] "AKAR4"   "AKAR4_C" "AKAR4p"  "C"</span></span>
<span><span class="co">#&gt; Units:</span></span>
<span><span class="co">#&gt; [1] "micromole/liter" "micromole/liter" "micromole/liter" "micromole/liter"</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; There is no «Input» Table in this model.</span></span>
<span><span class="co">#&gt; units in «!Unit» column:</span></span>
<span><span class="co">#&gt; [1] "micromole/liter"          "1/(micromolarity*second)"</span></span>
<span><span class="co">#&gt; [3] "1/second"                 "liter"</span></span>
<span><span class="co">#&gt; automatically created sbml unit ids:</span></span>
<span><span class="co">#&gt; [1] "micromole_per_liter"           "one_over_micromolarity_second"</span></span>
<span><span class="co">#&gt; [3] "one_over_second"               "liter"                        </span></span>
<span><span class="co">#&gt; [1] "Compartment"</span></span>
<span><span class="co">#&gt; [1] "AKAR4"</span></span>
<span><span class="co">#&gt; unit of species 1 (AKAR4): «micromole_per_liter»</span></span>
<span><span class="co">#&gt; [1] "AKAR4_C"</span></span>
<span><span class="co">#&gt; unit of species 2 (AKAR4_C): «micromole_per_liter»</span></span>
<span><span class="co">#&gt; [1] "AKAR4p"</span></span>
<span><span class="co">#&gt; unit of species 3 (AKAR4p): «micromole_per_liter»</span></span>
<span><span class="co">#&gt; [1] "C"</span></span>
<span><span class="co">#&gt; unit of species 4 (C): «micromole_per_liter»</span></span>
<span><span class="co">#&gt; adding SBtab parameter 1: «kf_C_AKAR4»</span></span>
<span><span class="co">#&gt; unit of parameter 1 (kf_C_AKAR4): «one_over_micromolarity_second»</span></span>
<span><span class="co">#&gt; adding SBtab parameter 2: «kb_C_AKAR4»</span></span>
<span><span class="co">#&gt; unit of parameter 2 (kb_C_AKAR4): «one_over_second»</span></span>
<span><span class="co">#&gt; adding SBtab parameter 3: «kcat_AKARp»</span></span>
<span><span class="co">#&gt; unit of parameter 3 (kcat_AKARp): «one_over_second»</span></span>
<span><span class="co">#&gt; adding reaction 1: «reaction_1»</span></span>
<span><span class="co">#&gt; converting flux to mathml: «kf_C_AKAR4*C*AKAR4 - kb_C_AKAR4*AKAR4_C»</span></span>
<span><span class="co">#&gt; reaction rates in SBML need to have the unit «substance/time» rather than «concentration/time».</span></span>
<span><span class="co">#&gt; So conventional kinetics need to be multiplied by compartment volumes.</span></span>
<span><span class="co">#&gt; Since this model has only one Compartment, all kinetics will be multiplied by its volume for the SBML model.</span></span>
<span><span class="co">#&gt; [SBML] Reactants:</span></span>
<span><span class="co">#&gt; [1] "C"     "AKAR4"</span></span>
<span><span class="co">#&gt; [SBML] Products:</span></span>
<span><span class="co">#&gt; [1] "AKAR4_C"</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; [1] "C" ""  "C"</span></span>
<span><span class="co">#&gt; [1] "AKAR4" ""      "AKAR4"</span></span>
<span><span class="co">#&gt; [1] "AKAR4_C" ""        "AKAR4_C"</span></span>
<span><span class="co">#&gt; adding reaction 2: «reaction_2»</span></span>
<span><span class="co">#&gt; converting flux to mathml: «kcat_AKARp*AKAR4_C»</span></span>
<span><span class="co">#&gt; reaction rates in SBML need to have the unit «substance/time» rather than «concentration/time».</span></span>
<span><span class="co">#&gt; So conventional kinetics need to be multiplied by compartment volumes.</span></span>
<span><span class="co">#&gt; Since this model has only one Compartment, all kinetics will be multiplied by its volume for the SBML model.</span></span>
<span><span class="co">#&gt; [SBML] Reactants:</span></span>
<span><span class="co">#&gt; [1] "AKAR4_C"</span></span>
<span><span class="co">#&gt; [SBML] Products:</span></span>
<span><span class="co">#&gt; [1] "AKAR4p" "C"</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; [1] "AKAR4_C" ""        "AKAR4_C"</span></span>
<span><span class="co">#&gt; [1] "AKAR4p" ""       "AKAR4p"</span></span>
<span><span class="co">#&gt; [1] "C" ""  "C"</span></span>
<span><span class="co">#&gt; output 1:</span></span>
<span><span class="co">#&gt; [1] "AKAR4pOUT"</span></span>
<span><span class="co">#&gt; unit of output 1 (AKAR4pOUT): «micromole_per_liter»</span></span>
<span><span class="co">#&gt; output 1 has formula:</span></span>
<span><span class="co">#&gt; [1] "108 + 380*AKAR4p"</span></span>
<span><span class="co">#&gt; 108 + 380 * AKAR4p</span></span>
<span><span class="co">#&gt; The sbml file has been named «AKAR4.xml».</span></span>
<span><span class="co">#&gt; class(IsConstant): logical.</span></span>
<span><span class="co">#&gt; [1] Formula Unit   </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; [1] Formula Unit   </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="co">#&gt; character(0)</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; character</span></span>
<span><span class="co">#&gt; Reaction 1:line (a-&gt;b): «C + AKAR4 » ←→ « AKAR4_C»</span></span>
<span><span class="co">#&gt;  where a: [1] "C "      " AKAR4 "</span></span>
<span><span class="co">#&gt;    and b: [1] " AKAR4_C"</span></span>
<span><span class="co">#&gt; Products:</span></span>
<span><span class="co">#&gt; 1 × AKAR4_C          (AKAR4_C is compound 2)</span></span>
<span><span class="co">#&gt; Reactants:</span></span>
<span><span class="co">#&gt; 1 × C            (C is compound 4)</span></span>
<span><span class="co">#&gt; 1 × AKAR4            (AKAR4 is compound 1)</span></span>
<span><span class="co">#&gt; Reaction 2:line (a-&gt;b): «AKAR4_C » ←→ « AKAR4p + C»</span></span>
<span><span class="co">#&gt;  where a: [1] "AKAR4_C "</span></span>
<span><span class="co">#&gt;    and b: [1] " AKAR4p " " C"      </span></span>
<span><span class="co">#&gt; Products:</span></span>
<span><span class="co">#&gt; 1 × AKAR4p           (AKAR4p is compound 3)</span></span>
<span><span class="co">#&gt; 1 × C            (C is compound 4)</span></span>
<span><span class="co">#&gt; Reactants:</span></span>
<span><span class="co">#&gt; 1 × AKAR4_C          (AKAR4_C is compound 2)</span></span>
<span><span class="co">#&gt; Number of compounds: 4</span></span>
<span><span class="co">#&gt; Number of Reactions: 2</span></span>
<span><span class="co">#&gt; The vf content was written to: AKAR4.vf</span></span>
<span><span class="co">#&gt; The mod content was written to: AKAR4.mod</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">SBtabVFGEN</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SBtabVFGEN/man/sbtab.data.html" class="external-link">sbtab.data</a></span><span class="op">(</span><span class="va">sb</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu">uqsa</span><span class="fu">::</span><span class="fu"><a href="../reference/generateCode.html">generateCode</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">C</span>,sep<span class="op">=</span><span class="st">"\n"</span>,file<span class="op">=</span><span class="st">"./AKAR4_gvf.c"</span><span class="op">)</span></span>
<span><span class="va">modelName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/checkModel.html">checkModel</a></span><span class="op">(</span><span class="st">"AKAR4"</span>,modelFile<span class="op">=</span><span class="st">"./AKAR4_gvf.c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; building a shared library from c source, and using GSL odeiv2 as backend (pkg-config is used here).</span></span>
<span><span class="co">#&gt; cc -shared -fPIC `pkg-config --cflags gsl` -o './AKAR4.so' './AKAR4_gvf.c' `pkg-config --libs gsl`</span></span></code></pre></div>
<div class="section level3">
<h3 id="create-simulator">Create simulator<a class="anchor" aria-label="anchor" href="#create-simulator"></a>
</h3>
<p>We construct a simulator function and and test it on default
parameter values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simcf.html">simcf</a></span><span class="op">(</span><span class="va">ex</span>,<span class="va">modelName</span>,parMap<span class="op">=</span><span class="va">log10ParMap</span><span class="op">)</span> <span class="co"># or simulator.c</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">sb</span><span class="op">$</span><span class="va">Parameter</span><span class="op">[[</span><span class="st">"!DefaultValue"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sb</span><span class="op">$</span><span class="va">Parameter</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">s</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="co"># here the simulation happens</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="uncertainty-quantification-sample-the-posterior-distribution">Uncertainty quantification: Sample the posterior distribution<a class="anchor" aria-label="anchor" href="#uncertainty-quantification-sample-the-posterior-distribution"></a>
</h3>
<p>For details on how to sample from the posterior distribution, see
e.g. the deterministic <a href="sampleAKAR4.html">AKAR4</a> example.
First we construct the prior:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dprior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dNormalPrior.html">dNormalPrior</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">rprior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rNormalPrior.html">rNormalPrior</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">llf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logLikelihoodFunc.html">logLikelihoodFunc</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span></span>
<span><span class="co">#&gt; experiments contain 675 non-missing values</span></span>
<span><span class="va">metropolis_hastings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcUpdate.html">mcmcUpdate</a></span><span class="op">(</span><span class="va">s</span>,<span class="va">ex</span>,logLikelihood<span class="op">=</span><span class="va">llf</span>,dprior<span class="op">=</span><span class="va">dprior</span><span class="op">)</span></span>
<span><span class="va">MH_MCMC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">metropolis_hastings</span><span class="op">)</span></span></code></pre></div>
<p>We obtain a high quality sample by combining several smaller samples
using different random starting locations, removing the burn-in phase of
each chain and adjust the stepsize at least once (for details see the <a href="sampleAKAR4.html">example</a>). This will take a minute or so on a
laptop.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">a</span><span class="op">^</span><span class="fl">4</span><span class="op">/</span><span class="op">(</span><span class="fl">0.25</span><span class="op">^</span><span class="fl">4</span> <span class="op">+</span> <span class="va">a</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">137</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">5e-2</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">3e4</span></span>
<span></span>
<span><span class="va">nCores</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bigSample</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nCores</span><span class="op">)</span>,</span>
<span>    \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmcInit.html">mcmcInit</a></span><span class="op">(</span></span>
<span>            <span class="fl">1.0</span>,</span>
<span>            parMCMC<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">rprior</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            simulate<span class="op">=</span><span class="va">s</span>,</span>
<span>            logLikelihood<span class="op">=</span><span class="va">llf</span>,</span>
<span>            dprior<span class="op">=</span><span class="va">dprior</span><span class="op">)</span></span>
<span>        <span class="co">## adjust acceptance rate to 25% via step-size h</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">MH_MCMC</span><span class="op">(</span><span class="va">x</span>,<span class="fl">200</span>,<span class="va">h</span><span class="op">)</span></span>
<span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">z</span>,<span class="st">"lastPoint"</span><span class="op">)</span></span>
<span>            <span class="va">h</span> <span class="op">&lt;-</span> <span class="va">h</span><span class="op">*</span><span class="fu">A</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">z</span>,<span class="st">"acceptanceRate"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">MH_MCMC</span><span class="op">(</span><span class="va">x</span>,<span class="va">N</span>,<span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    mc.cores<span class="op">=</span><span class="va">nCores</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">S_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span><span class="op">}</span>,<span class="va">bigSample</span>,init<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">L_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>,<span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">b</span>,<span class="st">"logLikelihood"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,<span class="va">bigSample</span>,init<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S_</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/hexbin" class="external-link">hexbin</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">hexbin</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hexbin/man/hexplom.html" class="external-link">hexplom</a></span><span class="op">(</span><span class="va">S_</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">S_</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: hexbin</span></span></code></pre></div>
<p><img src="uqsaAKAR4_files/figure-html/pairs-2-1.png" width="1200"></p>
</div>
<div class="section level3">
<h3 id="sensitivity-analysis-on-the-posterior-distribution">Sensitivity analysis on the posterior distribution<a class="anchor" aria-label="anchor" href="#sensitivity-analysis-on-the-posterior-distribution"></a>
</h3>
<p>First we need to (re-)create the simulation result corresponding to
the posterior parameter sample, now we set up the model without
conservation laws so that we get output trajectories for all compounds.
This will take a minute or so on a laptop.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simcf.html">simcf</a></span><span class="op">(</span><span class="va">ex</span>,<span class="va">modelName</span>,parMap<span class="op">=</span><span class="va">log10ParMap</span><span class="op">)</span> <span class="co"># or simulator.c</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">s</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">S_</span><span class="op">[</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next we calculate the first order sensitivity indexes. Here for a
specific experimental setting and time point:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">2</span>                      <span class="co"># Experiment idx</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">60</span>                     <span class="co"># Time idx</span></span>
<span><span class="va">fM</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">[</span>,<span class="cn">T</span>,<span class="op">]</span></span>
<span><span class="va">SIappr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globalSensitivity.html">globalSensitivity</a></span><span class="op">(</span><span class="va">S_</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fM</span><span class="op">)</span>, nBins <span class="op">=</span> <span class="st">"Sturges"</span><span class="op">)</span></span></code></pre></div>
<p>and plot:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fM</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">[</span>,<span class="cn">T</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">SIappr</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="va">cols</span>,</span>
<span>        border<span class="op">=</span><span class="st">"white"</span>,</span>
<span>        space<span class="op">=</span><span class="fl">0.04</span>,</span>
<span>        cex.axis<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>        legend.text<span class="op">=</span><span class="va">sb</span><span class="op">$</span><span class="va">Parameter</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="uqsaAKAR4_files/figure-html/barplot-1-1.png" width="700"></p>
<p>Or for all three experiments:</p>
<p>Next we calculate the first order sensitivity indexes. Here for a
specific timepoint and all three experimental conditions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">200</span>                    <span class="co">#Time idx</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">E</span> <span class="kw">in</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">fM</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">[</span>,<span class="cn">T</span>,<span class="op">]</span></span>
<span><span class="va">SIappr</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/globalSensitivity.html">globalSensitivity</a></span><span class="op">(</span><span class="va">S_</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fM</span><span class="op">)</span> , nBins <span class="op">=</span> <span class="st">"Sturges"</span><span class="op">)</span></span>
<span><span class="va">lgd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sb</span><span class="op">$</span><span class="va">Parameter</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="cn">NULL</span>,<span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">SIappr</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="va">cols</span>,</span>
<span>        cex.names <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        las<span class="op">=</span><span class="fl">2</span>,</span>
<span>        border<span class="op">=</span><span class="st">"white"</span>,</span>
<span>        space<span class="op">=</span><span class="fl">0.04</span>,</span>
<span>        cex.axis<span class="op">=</span><span class="fl">1</span>,</span>
<span>        main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span><span class="op">[</span><span class="va">E</span><span class="op">]</span>,</span>
<span>        legend.text<span class="op">=</span><span class="va">lgd</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="uqsaAKAR4_files/figure-html/barplot-2-1.png" width="700"></p>
<p>Now we investigate a number of times instead of different
species:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">timePts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">40</span>,by<span class="op">=</span><span class="fl">4</span><span class="op">)</span>  <span class="co">#Avoid first time point</span></span>
<span><span class="va">nStates</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">cols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nStates</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lgd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span>,<span class="va">nStates</span><span class="op">)</span></span>
<span><span class="va">lgd</span><span class="op">[[</span><span class="va">nStates</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sb</span><span class="op">$</span><span class="va">Parameter</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">Cm</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nStates</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fM</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">[</span><span class="va">Cm</span>,<span class="va">timePts</span>,<span class="op">]</span></span>
<span>  <span class="va">SIappr</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/globalSensitivity.html">globalSensitivity</a></span><span class="op">(</span><span class="va">S_</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fM</span><span class="op">)</span> , nBins <span class="op">=</span> <span class="st">"Sturges"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">SIappr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">timePts</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">SIappr</span><span class="op">)</span>,</span>
<span>          col<span class="op">=</span><span class="va">cols</span>,</span>
<span>          names.arg <span class="op">=</span> <span class="va">timePts</span>,</span>
<span>          border<span class="op">=</span><span class="st">"white"</span>,</span>
<span>          cex.axis<span class="op">=</span><span class="fl">1</span>,</span>
<span>          main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="va">E</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">Cm</span><span class="op">]</span>,</span>
<span>          xlab<span class="op">=</span><span class="st">"Time"</span>,</span>
<span>          ylab<span class="op">=</span><span class="st">"SI"</span>,</span>
<span>          legend.text<span class="op">=</span><span class="va">lgd</span><span class="op">[[</span><span class="va">Cm</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"topright"</span>, inset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ex</span><span class="op">[</span><span class="va">E</span><span class="op">]</span><span class="op">)</span>, side<span class="op">=</span><span class="fl">3</span>, line <span class="op">=</span> <span class="op">-</span> <span class="fl">1.5</span>,outer<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="uqsaAKAR4_files/figure-html/barplot-3-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexandra Jauhiainen, Olivia Eriksson, Federica Milinanni, Andrei Kramer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
